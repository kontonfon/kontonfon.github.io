---
layout: post
title: Mysql Training
subtitle: Hackerank
cover-img: /assets/img/path.jpg
thumbnail-img: /assets/img/lala.png
share-img: /assets/img/path.jpg
tags: mysql

---


<style TYPE="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
    }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML-full"></script>

----------------

#### <span style="color:#4cbb17"> Bài 1: </span>

![Imgur](https://i.imgur.com/AixsxLw.png)


```sql
select * from CITY where POPULATION > 100000 and COUNTRYCODE = "USA";
```
#### <span style="color:#4cbb17"> Bài 2: </span>

![Imgur](https://i.imgur.com/g5jwpVy.png)

```sql
select NAME from CITY where POPULATION > 120000 and COUNTRYCODE = "USA";
```

#### <span style="color:#4cbb17"> Bài 3: </span>

![Imgur](https://i.imgur.com/dYKtcWq.png)

```sql
select * from CITY; 
```

#### <span style="color:#4cbb17"> Bài 4: </span>

![Imgur](https://i.imgur.com/wHlMI8t.png)

```sql
select * from CITY where ID = 1661;
```

#### <span style="color:#4cbb17"> Bài 5: </span>

![Imgur](https://i.imgur.com/VNWNv9l.png)

```sql
SELECT * FROM CITY WHERE COUNTRYCODE = "JPN";
```

#### <span style="color:#4cbb17"> Bài 6: </span>

![Imgur](https://i.imgur.com/HeHxZGd.png)

```sql
SELECT NAME FROM CITY WHERE COUNTRYCODE = "JPN";
```

#### <span style="color:#4cbb17"> Bài 7: </span>

![Imgur](https://i.imgur.com/Ni5HDYH.png)

```sql
SELECT CITY,STATE FROM STATION;
```

#### <span style="color:#4cbb17"> Bài 8: </span>

![Imgur](https://i.imgur.com/9jjNVm6.png)

```sql
SELECT DISTINCT CITY FROM STATION WHERE ID%2=0;
```

#### <span style="color:#4cbb17"> Bài 9: </span>

![Imgur](https://i.imgur.com/NDZa6p3.png)

![Imgur](https://i.imgur.com/f1a31O4.png)

```sql
SELECT COUNT(CITY) - COUNT(DISTINCT CITY) FROM STATION;
```

#### <span style="color:RED"> *** HARDER *** </span>

#### <span style="color:#4cbb17"> Bài 10: </span>

![Imgur](https://i.imgur.com/TuDo79d.png)

![Imgur](https://i.imgur.com/pc2Yrlb.png)

```sql
SELECT CITY, LENGTH(CITY) FROM STATION
ORDER BY LENGTH(CITY),CITY
LIMIT 1;

SELECT CITY, LENGTH(CITY) FROM STATION
ORDER BY LENGTH(CITY) DESC,CITY
LIMIT 1;
```

#### <span style="color:#4cbb17"> Bài 11: </span>

![Imgur](https://i.imgur.com/g0mmEqi.png)

```sql
SELECT DISTINCT CITY FROM STATION WHERE SUBSTRING(CITY,1,1) IN ('a','e','i','o','u','A','E','I','O','U'); 
```

#### <span style="color:#4cbb17"> Bài 12: </span>

![Imgur](https://i.imgur.com/JUyCT7r.png)

```sql
SELECT DISTINCT CITY FROM STATION WHERE SUBSTRING(CITY,-1,1) IN ('a','e','i','o','u','A','E','I','O','U');
```

#### <span style="color:#4cbb17"> Bài 13: </span>

![Imgur](https://i.imgur.com/QbHRsoH.png)

```sql
SELECT DISTINCT CITY FROM STATION WHERE SUBSTRING(CITY,1,1) IN ('a','e','i','o','u','A','E','I','O','U') AND SUBSTRING(CITY,-1,1) IN ('a','e','i','o','u','A','E','I','O','U');
```

#### <span style="color:#4cbb17"> Bài 14: </span>

![Imgur](https://i.imgur.com/JkxEf2p.png)

```sql
SELECT DISTINCT CITY FROM STATION WHERE SUBSTRING(CITY,1,1) NOT IN ('a','e','i','o','u','A','E','I','O','U');
```

#### <span style="color:#4cbb17"> Bài 15: </span>

![Imgur](https://i.imgur.com/OpaKV9X.png)

```sql
SELECT DISTINCT CITY FROM STATION WHERE SUBSTRING(CITY,-1,1) NOT IN ('a','e','i','o','u','A','E','I','O','U');
```

#### <span style="color:RED">*** HARDER LEVEL 2: *** </span>

#### <span style="color:#4cbb17"> Bài 16: </span>

![Imgur](https://i.imgur.com/Z5CkXqk.png)

```sql
SELECT DISTINCT CITY FROM STATION WHERE SUBSTRING(CITY,1,1) NOT IN ('a','e','i','o','u','A','E','I','O','U') OR SUBSTRING(CITY,-1,1) NOT IN ('a','e','i','o','u','A','E','I','O','U');
```

#### <span style="color:#4cbb17"> Bài 17: </span>

![Imgur](https://i.imgur.com/kzkQZJg.png)

```sql
SELECT DISTINCT CITY FROM STATION WHERE SUBSTRING(CITY,1,1) NOT IN ('a','e','i','o','u','A','E','I','O','U') AND SUBSTRING(CITY,-1,1) NOT IN ('a','e','i','o','u','A','E','I','O','U');
```

#### <span style="color:#4cbb17"> Bài 18: </span>

![Imgur](https://i.imgur.com/Hvoshzc.png)
![Imgur](https://i.imgur.com/vhJl1ra.png)

```sql
SELECT NAME FROM STUDENTS WHERE MARKS > 75
ORDER BY RIGHT(NAME,3),ID;
```

#### <span style="color:#4cbb17"> Bài 19: </span>

![Imgur](https://i.imgur.com/Tz13KJI.png)
![Imgur](https://i.imgur.com/uU3vr7j.png)

```sql
SELECT NAME FROM EMPLOYEE
ORDER BY NAME;
```

#### <span style="color:#4cbb17"> Bài 20: </span>

![Imgur](https://i.imgur.com/X5oHJGr.png)
![Imgur](https://i.imgur.com/62FS9gU.png)

```sql
SELECT NAME FROM EMPLOYEE WHERE SALARY > 2000 AND MONTHS < 10
ORDER BY EMPLOYEE_ID;
```

#### <span style="color:RED">*** HARDER LEVEL 3: *** </span>

#### <span style="color:#4cbb17"> Bài 21: </span>

![Imgur](https://i.imgur.com/L3w3Rff.png)

```sql
SET @TEMP:=21; 
SELECT REPEAT('* ', @TEMP:= @TEMP - 1) 
FROM INFORMATION_SCHEMA.TABLES;
```

#### <span style="color:#4cbb17"> Bài 22: </span>

![Imgur](https://i.imgur.com/WP7vPKo.png)

```sql
SET @TEMP:=0; 
SELECT REPEAT('* ', @TEMP:= @TEMP + 1) 
FROM INFORMATION_SCHEMA.TABLES
WHERE @TEMP < 20;
```

#### <span style="color:#4cbb17"> Bài 23: </span>

![Imgur](https://i.imgur.com/FybJXJk.png)
![Imgur](https://i.imgur.com/HYRXkRL.png)

```sql
SELECT CASE
            WHEN A+B>C AND B+C>A AND A+C>B THEN
                CASE
                    WHEN A=B AND B=C THEN 'Equilateral'
                    WHEN A=B OR B=C OR A=C THEN 'Isosceles'
                    ELSE 'Scalene'
                END
            ELSE 'Not A Triangle'
            END
FROM TRIANGLES;
```
#### <span style="color:#4cbb17"> Bài 24: </span>

![Imgur](https://i.imgur.com/rlqzZbq.png)
![Imgur](https://i.imgur.com/HsifW2G.png)
![Imgur](https://i.imgur.com/D14Xl7e.png)

```sql
SELECT CONCAT(NAME,'(',LEFT(OCCUPATION,1),')') FROM OCCUPATIONS 
ORDER BY NAME;
SELECT CONCAT('There are a total of ',COUNT(OCCUPATION),' ',LOWER(OCCUPATION),'s.') AS TOTAL FROM OCCUPATIONS
GROUP BY OCCUPATION ORDER BY TOTAL;
```

#### <span style="color:#4cbb17"> ***** Note ***** </span>

~~~
GROUP BY: Là sort lại và chỉ lấy cái đại diện thôi còn ORDER BY: thì cũng sắp xếp lại và lấy luôn những cái giống nhau !
~~~

#### <span style="color:#4cbb17"> (**) Bài 25: </span>

![Imgur](https://i.imgur.com/5n7K5JR.png)
![Imgur](https://i.imgur.com/MbmefDj.png)
![Imgur](https://i.imgur.com/sj0JkSW.png)

Solution: [Don't see example because input not example]

** Step 1: ** 

Create a virtual table in your head of data given to us. It look like us:

![Imgur](https://i.imgur.com/eBBn6CN.png)

```sql
SELECT
    case when Occupation='Doctor' then Name end as Doctor,
    case when Occupation='Professor' then Name end as Professor,
    case when Occupation='Singer' then Name end as Singer,
    case when Occupation='Actor' then Name end as Actor
FROM OCCUPATIONS
```

Explanation: `END AS` in `mysql`

```sql
SELECT OrderID, Quantity,
CASE WHEN Quantity > 30 THEN 'The quantity is greater than 30'
WHEN Quantity = 30 THEN 'The quantity is 30'
ELSE 'The quantity is under 30'
END AS QuantityText
FROM OrderDetails;
```

![Imgur](https://i.imgur.com/80rZqet.png)

** Step 2: **

Create an index column with respect to occupation as "RowNumber"

![Imgur](https://i.imgur.com/PaC7sEQ.png)

Notice from the image, under professor column, the first Name is indexed as 1, the next name "Birtney" as 2. That is what I mean by index w.r.t occupation.

The below code will only give the "RowNumber" column, to get the result like in image proceed to step 3

```
set @r1=0, @r2=0, @r3=0, @r4=0;

SELECT case 
	when Occupation='Doctor' then (@r1:=@r1+1)
        when Occupation='Professor' then (@r2:=@r2+1)
        when Occupation='Singer' then (@r3:=@r3+1)
        when Occupation='Actor' then (@r4:=@r4+1) end as RowNumber

FROM OCCUPATIONS
```

** Step 3: **

Combine the result from step 1 and step 2:
  
```sql
set @r1=0, @r2=0, @r3=0, @r4=0;

SELECT case 
	when Occupation='Doctor' then (@r1:=@r1+1)
        when Occupation='Professor' then (@r2:=@r2+1)
        when Occupation='Singer' then (@r3:=@r3+1)
        when Occupation='Actor' then (@r4:=@r4+1) end as RowNumber,
        case when Occupation='Doctor' then Name end as Doctor,
        case when Occupation='Professor' then Name end as Professor,
        case when Occupation='Singer' then Name end as Singer,
        case when Occupation='Actor' then Name end as Actor

FROM OCCUPATIONS

```

** Step 4: **

Now, Order_by name the Group_By RowNumber

Using Min/Max, if there is a name, it will return it, if not, return NULL.

```sql
set @r1=0, @r2=0, @r3=0, @r4=0;
select min(Doctor), min(Professor), min(Singer), min(Actor)
from(
  select case when Occupation='Doctor' then (@r1:=@r1+1)
            when Occupation='Professor' then (@r2:=@r2+1)
            when Occupation='Singer' then (@r3:=@r3+1)
            when Occupation='Actor' then (@r4:=@r4+1) end as RowNumber,
    case when Occupation='Doctor' then Name end as Doctor,
    case when Occupation='Professor' then Name end as Professor,
    case when Occupation='Singer' then Name end as Singer,
    case when Occupation='Actor' then Name end as Actor
  from OCCUPATIONS
  order by Name
	) temp
group by RowNumber;
```

#### <span style="color:#4cbb17"> Bài 25: </span>

!
!
!

```sql
```

