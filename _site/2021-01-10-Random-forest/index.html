<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>Random Forest Algorithm</title>

  
  <meta name="author" content="Ngô Tấn Trí">
  

  <meta name="description" content="Random Forest Algorithm">

  

  

  <link rel="alternate" type="application/rss+xml" title="Em0t3t" href="http://localhost:4000/feed.xml">

  

  

  


  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="Em0t3t">
  <meta property="og:title" content="Random Forest Algorithm">
  <meta property="og:description" content="Random Forest Algorithm">

  
  <meta property="og:image" content="http://localhost:4000/assets/img/path.jpg">
  

  
  <meta property="og:type" content="article">
  <meta property="og:article:author" content="Ngô Tấn Trí">
  <meta property="og:article:published_time" content="2021-01-10T00:00:00+00:00">
  <meta property="og:url" content="http://localhost:4000/2021-01-10-Random-forest/">
  <link rel="canonical" href="http://localhost:4000/2021-01-10-Random-forest/">
  

  
  <meta name="twitter:card" content="summary_large_image">
  
  <meta name="twitter:site" content="@daattali">
  <meta name="twitter:creator" content="@daattali">

  <meta property="twitter:title" content="Random Forest Algorithm">
  <meta property="twitter:description" content="Random Forest Algorithm">

  
  <meta name="twitter:image" content="http://localhost:4000/assets/img/path.jpg">
  

  


  

  

</head>


<body>

  


  <nav class="navbar navbar-expand-xl navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand" href="http://localhost:4000/">Em0t3t</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/aboutme">About Me</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="https://beautifuljekyll.com">Beautiful Jekyll</a>
                  <a class="dropdown-item" href="https://www.markdowntutorial.com/">Learn markdown</a>
            </div>
          </li>
        
          <li class="nav-item">
            <a class="nav-link" href="https://deanattali.com">Author's home</a>
          </li></ul>
  </div>

  

  
    <div class="avatar-container">
      <div class="avatar-img-border">
        <a href="http://localhost:4000/">
          <img alt="Navigation bar avatar" class="avatar-img" src="/assets/img/LOGODUT.png" />
        </a>
      </div>
    </div>
  

</nav>


  <!-- TODO this file has become a mess, refactor it -->






  <div id="header-big-imgs" data-num-img=1
    
    
    
      
      data-img-src-1="http://localhost:4000/assets/img/path.jpg"
    
    
    
  ></div>


<header class="header-section has-img">

<div class="big-img intro-header">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Random Forest Algorithm</h1>
          
            
              <h2 class="post-subheading">Random Forest Algorithm</h2>
            
          

          
            <span class="post-meta">Posted on January 10, 2021</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
  <span class='img-desc'></span>
</div>

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Random Forest Algorithm</h1>
          
            
              <h2 class="post-subheading">Random Forest Algorithm</h2>
            
          

          
            <span class="post-meta">Posted on January 10, 2021</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class=" container-md ">
  <div class="row">
    <div class=" col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 ">

      

      

      <article role="main" class="blog-post">
        <style type="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
    }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML-full"></script>

<hr />
<p><a href="https://www.youtube.com/watch?v=J4Wdy0Wc_xQ">Link</a></p>

<h3 id="part-1---buiding-using-and-evaluating">Part 1 - Buiding, Using and Evaluating</h3>

<p>We’re gonna be starting part one of a series on random forests, and we’re going to to talk about building and evaluating random forests.</p>

<p>Note random forests are built from decision trees. So if you don’t already know about these check out my stat quest and breef up</p>

<p>Decision trees are easy to build easy to use and easy to interpret</p>

<p>But in practice they are not awesome</p>

<p>To quote from the elements of statistical learning aka of Bible of machine learning</p>

<p>Trees have one aspect that prevents them from being the ideal tool for predictive learning</p>

<p>Namely in accuracy.</p>

<p>But they are not flexible when it comes to classifying new samples</p>

<p>The good news is that random forest combine the simplicit of decision tree with flexibility. Resulting in a vast improvement in accuracy.</p>

<p>So let’s make a random forest</p>

<p><img src="https://i.imgur.com/k20IcOV.png" alt="Imgur" /></p>

<p>Step 1: Create a “bootstrapped” dataset.</p>

<p>Imagine that these 4 samples are the entire data set that we are going to build a tree from I know it’s crazy small, but just pretend for now. To create a bootstrap data set that is the same size as the original. We just randomly select samples from the original data set. The important detail is that we’re allowed to pick the same sample more than once. This is the firs sample that we randomly select</p>

<p><img src="https://i.imgur.com/r0pNF1U.png" alt="Imgur" /></p>

<p>So it’s the first sample in our bootstrap data set. This is the second randomly selected sample from the original data set. So it’s the second sample in our bootstrap data set. Here’s the third randomly selected sample. So here it is in the bootstrap data set</p>

<p><img src="https://i.imgur.com/kxIxXh7.png" alt="Imgur" /></p>

<p>Lastly here’s the fourth randomly selected sample note. It’s the same as the third and here it is.</p>

<p><img src="https://i.imgur.com/msov6fs.png" alt="Imgur" /></p>

<p>Bam ! We’ve created a bootstrap data set</p>

<p>Step 2: For creating a random forest is to create a decision tree using the bootstrap dataset. But only use a random subset of variables or columns at each step.</p>

<p>In this example, we will only consider two variables or columns at each step.</p>

<p>Note, we’ll talk more abour how to determin the optimal number of variables to consider later.</p>

<p>Thus instead of considering all four variables to figure out how to split the root node . We randomly select two in .</p>

<p>In this case, we randomly selected good blood circulation and blocked arteties as candidates for the root node.</p>

<p>Just the sake of the example assume that good blood circulation. Did the best job separating the sample ?</p>

<p>Since we used a good blood circulation. I’m going to gray it out so that we focus on the remaining variables</p>

<p><img src="https://i.imgur.com/6s0GSi7.png" alt="Imgur" /></p>

<p>Now we need to figure out how to split samples at this node , just like for the route we randomly select two variables as candidates instead of all three remaining columns and we just build the tree as usual, but only considering a random subset of variables at each step</p>

<p>Double bound, we built a tree one using a bootstrap data set and two only considering a random subset of variables at each step. Here’s tree we just made, Now, go back to step on and repeat. Make a new bootstrap data set and build a tree considering a subset of variables at each step. Ideally, you do this hundreds of times, but we only have space to show six, but you get the idea. Using a bootstrap sample and considering only a subset of variables at each step results in a wide variety of trees . The variety is what makes random forests more effective than individual trees. Sweet, now that we’ve created a random forest. How do we use it ?</p>

<p><img src="https://i.imgur.com/HTfVMp9.png" alt="Imgur" /></p>

<p>Well first we get a new patient, We’ve got all measurement and now we want to know if they heart disease or not. So we take the data and run it down the first tree that we made.</p>

<p>The first tree says yes, the patient has heart disease and we keep track of that here.</p>

<p>Now, we run the data down the second tree that we made the second tree also says yes and we keep track of that here. And then we repeat for all the trees we made. After running the data down all of the trees in the random forest. We see which option received more votes . In this case, yes received the most votes so we will conclude that this patient has heart disease</p>

<p>BAM !!!</p>

<p><img src="https://i.imgur.com/KqpWXib.png" alt="Imgur" /></p>

<p>No terminology Alert !</p>

<p>Bootstrapping the data plus using the aggregate to make a decision is called bagging</p>

<p>Okay, now we’ve seen how to create and use a random forest. How do we know if it’s any good. Remember when we created the bootstrapped data set. We allow duplicates in trees in the bootstrapped data set as a result. This entry was not included in the bootstrap data set. Typically about one third of the original data does not end up in the bootstrap data set.</p>

<p>Here’s the entry that didn’t end up in the bootstrapped dataset. If the original dataset were larger, we’d have more than just one entry over here . This is called the out-of-bag dataset . If it were up to me, I would have named it three out of boot data set since it’s the entries that didn’t make it into the bootstrap dataset.</p>

<p>Since the out-of-bag data was not used to create this tree. We can run it through and see if it correctly classifies the sample as no heart disease.</p>

<p>In this case, the tree correctly labels the out of bag sample. No</p>

<p>Then we run this Out-of-Bag sample through all of the other trees that were built without it … This tree incorrectly labeled the ouf of bag sample. Yes</p>

<p><img src="https://i.imgur.com/F1BKmEE.png" alt="Imgur" /></p>

<p>These trees correctly labeled the Out-Of-Bag sample “No” . Since the label with the most votes wins, it is the label that we assign this Out-of-simple sample.</p>

<p>In this case, the Out-of-Bag sample is correctly labeled by the Random Forest.</p>

<p>We then do the same thing for all of the other Out-Of-Bag samples for all of the trees. This out of Bag sample was not also correctly labeled. This out-of-Bag sample was incorrectly labeled, etc.</p>

<p>Ultimately, we can measure how accurate our random forest is by the proportion of out-of-bag samples that were correctly classified by the random forest.</p>

<p>The proportion of out-of-bag samples that were incorrectly classified is the out of bag error,</p>

<p>Okay, we now know how to one build a random forest to use a random forest and three Estimate the accuracy of a Random Forest.</p>

<p>However, now that we know how to do this… . We can talk a little more about how to do this.</p>

<p><img src="https://i.imgur.com/msDwHaX.png" alt="Imgur" /></p>

<p>Remember when we built our first tree and we only use two variables column of data to make a decision at each step. Now we can compare the out-of-bag error for a random forest built using only two variables per step to a random forest built using three variables per step and we test a bunch of different settings and choose the most accurate random forest. In other words one we build a random forest and then two we estimate the accuracy of a random forest.</p>

<p>1) Build a Random Forest</p>

<p>2) Estimate the accuracy of a Random Forest</p>

<p>then we change the number of variables used per step and we do this a bunch of times and then choose the one that is the most accurate. Typically, we start by using the square of the number of variables and then try a few settings above and below that value</p>

      </article>

      
        <div class="blog-tags">
          <span>Tags:</span>
          
            <a href="/tags#latex">latex</a>
          
        </div>
      

      

      
        <!-- Check if any share-links are active -->




<section id = "social-share-section">
  <span class="sr-only">Share: </span>

  
    <a href="https://twitter.com/intent/tweet?text=Random+Forest+Algorithm&url=http%3A%2F%2Flocalhost%3A4000%2F2021-01-10-Random-forest%2F"
      class="btn btn-social-icon btn-twitter" title="Share on Twitter">
      <span class="fab fa-fw fa-twitter" aria-hidden="true"></span>
      <span class="sr-only">Twitter</span>
    </a>
  

  
    <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2021-01-10-Random-forest%2F"
      class="btn btn-social-icon btn-facebook" title="Share on Facebook">
      <span class="fab fa-fw fa-facebook" aria-hidden="true"></span>
      <span class="sr-only">Facebook</span>
    </a>
  

  
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2F2021-01-10-Random-forest%2F"
      class="btn btn-social-icon btn-linkedin" title="Share on LinkedIn">
      <span class="fab fa-fw fa-linkedin" aria-hidden="true"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  

  

</section>



      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/2021-01-10-Pre-lab-CCNA/" data-toggle="tooltip" data-placement="top" title="Pre Labs CCNA">&larr; Previous Post</a>
        </li>
        
        
      </ul>
      
  
  
  

  




    </div>
  </div>
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="/feed.xml" title="RSS">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">RSS</span>
    </a>
  </li><li class="list-inline-item">
    <a href="mailto:tritanngo99@gmail.com" title="Email me">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Email me</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://www.facebook.com/deanattali" title="Facebook">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Facebook</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://github.com/daattali" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://twitter.com/daattali" title="Twitter">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Twitter</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://www.youtube.com/c/daattali" title="YouTube">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">YouTube</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://patreon.com/DeanAttali" title="Patreon">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-patreon fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Patreon</span>
    </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
        Ngô Tấn Trí
        &nbsp;&bull;&nbsp;
      
      2021

      
        &nbsp;&bull;&nbsp;
        <span class="author-site">
          <a href="http://localhost:4000/">MyWebsite.com</a>
        </span>
      

      
      </p>
      <p class="theme-by text-muted">
        Powered by
        <a href="https://beautifuljekyll.com">Beautiful Jekyll</a>
      </p>
      </div>
    </div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
