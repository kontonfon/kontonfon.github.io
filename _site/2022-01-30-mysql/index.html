<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>Mysql and SQL Server Training</title>

  
  <meta name="author" content="Ngô Tấn Trí">
  

  <meta name="description" content="Hackerrank">

  

  

  <link rel="alternate" type="application/rss+xml" title="Em0t3t" href="http://localhost:4000/feed.xml">

  

  

  


  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="Em0t3t">
  <meta property="og:title" content="Mysql and SQL Server Training">
  <meta property="og:description" content="Hackerrank">

  
  <meta property="og:image" content="http://localhost:4000/assets/img/path.jpg">
  

  
  <meta property="og:type" content="article">
  <meta property="og:article:author" content="Ngô Tấn Trí">
  <meta property="og:article:published_time" content="2022-01-30T00:00:00+00:00">
  <meta property="og:url" content="http://localhost:4000/2022-01-30-mysql/">
  <link rel="canonical" href="http://localhost:4000/2022-01-30-mysql/">
  

  
  <meta name="twitter:card" content="summary_large_image">
  
  <meta name="twitter:site" content="@daattali">
  <meta name="twitter:creator" content="@daattali">

  <meta property="twitter:title" content="Mysql and SQL Server Training">
  <meta property="twitter:description" content="Hackerrank">

  
  <meta name="twitter:image" content="http://localhost:4000/assets/img/path.jpg">
  

  


  

  

</head>


<body>

  


  <nav class="navbar navbar-expand-xl navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand" href="http://localhost:4000/">Em0t3t</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/aboutme">About Me</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="https://beautifuljekyll.com">Beautiful Jekyll</a>
                  <a class="dropdown-item" href="https://www.markdowntutorial.com/">Learn markdown</a>
            </div>
          </li>
        
          <li class="nav-item">
            <a class="nav-link" href="https://deanattali.com">Author's home</a>
          </li></ul>
  </div>

  

  
    <div class="avatar-container">
      <div class="avatar-img-border">
        <a href="http://localhost:4000/">
          <img alt="Navigation bar avatar" class="avatar-img" src="/assets/img/LOGODUT.png" />
        </a>
      </div>
    </div>
  

</nav>


  <!-- TODO this file has become a mess, refactor it -->






  <div id="header-big-imgs" data-num-img=1
    
    
    
      
      data-img-src-1="http://localhost:4000/assets/img/path.jpg"
    
    
    
  ></div>


<header class="header-section has-img">

<div class="big-img intro-header">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Mysql and SQL Server Training</h1>
          
            
              <h2 class="post-subheading">Hackerrank</h2>
            
          

          
            <span class="post-meta">Posted on January 30, 2022</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
  <span class='img-desc'></span>
</div>

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Mysql and SQL Server Training</h1>
          
            
              <h2 class="post-subheading">Hackerrank</h2>
            
          

          
            <span class="post-meta">Posted on January 30, 2022</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class=" container-md ">
  <div class="row">
    <div class=" col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 ">

      

      

      <article role="main" class="blog-post">
        <style type="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
    }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML-full"></script>

<hr />

<h4 id="-bài-1-"><span style="color:#4cbb17"> Bài 1: </span></h4>

<p><img src="https://i.imgur.com/AixsxLw.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">CITY</span> <span class="k">where</span> <span class="n">POPULATION</span> <span class="o">&gt;</span> <span class="mi">100000</span> <span class="k">and</span> <span class="n">COUNTRYCODE</span> <span class="o">=</span> <span class="nv">"USA"</span><span class="p">;</span>
</code></pre></div></div>
<h4 id="-bài-2-"><span style="color:#4cbb17"> Bài 2: </span></h4>

<p><img src="https://i.imgur.com/g5jwpVy.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">NAME</span> <span class="k">from</span> <span class="n">CITY</span> <span class="k">where</span> <span class="n">POPULATION</span> <span class="o">&gt;</span> <span class="mi">120000</span> <span class="k">and</span> <span class="n">COUNTRYCODE</span> <span class="o">=</span> <span class="nv">"USA"</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-3-"><span style="color:#4cbb17"> Bài 3: </span></h4>

<p><img src="https://i.imgur.com/dYKtcWq.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">CITY</span><span class="p">;</span> 
</code></pre></div></div>

<h4 id="-bài-4-"><span style="color:#4cbb17"> Bài 4: </span></h4>

<p><img src="https://i.imgur.com/wHlMI8t.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">CITY</span> <span class="k">where</span> <span class="n">ID</span> <span class="o">=</span> <span class="mi">1661</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-5-"><span style="color:#4cbb17"> Bài 5: </span></h4>

<p><img src="https://i.imgur.com/VNWNv9l.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">CITY</span> <span class="k">WHERE</span> <span class="n">COUNTRYCODE</span> <span class="o">=</span> <span class="nv">"JPN"</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-6-"><span style="color:#4cbb17"> Bài 6: </span></h4>

<p><img src="https://i.imgur.com/HeHxZGd.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">NAME</span> <span class="k">FROM</span> <span class="n">CITY</span> <span class="k">WHERE</span> <span class="n">COUNTRYCODE</span> <span class="o">=</span> <span class="nv">"JPN"</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-7-"><span style="color:#4cbb17"> Bài 7: </span></h4>

<p><img src="https://i.imgur.com/Ni5HDYH.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">CITY</span><span class="p">,</span><span class="k">STATE</span> <span class="k">FROM</span> <span class="n">STATION</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-8-"><span style="color:#4cbb17"> Bài 8: </span></h4>

<p><img src="https://i.imgur.com/9jjNVm6.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">CITY</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="n">ID</span><span class="o">%</span><span class="mi">2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-9-"><span style="color:#4cbb17"> Bài 9: </span></h4>

<p><img src="https://i.imgur.com/NDZa6p3.png" alt="Imgur" /></p>

<p><img src="https://i.imgur.com/f1a31O4.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">CITY</span><span class="p">)</span> <span class="o">-</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">CITY</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">STATION</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="--harder--"><span style="color:RED"> <em>** HARDER **</em> </span></h4>

<h4 id="-bài-10-"><span style="color:#4cbb17"> Bài 10: </span></h4>

<p><img src="https://i.imgur.com/TuDo79d.png" alt="Imgur" /></p>

<p><img src="https://i.imgur.com/pc2Yrlb.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">CITY</span><span class="p">,</span> <span class="k">LENGTH</span><span class="p">(</span><span class="n">CITY</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">STATION</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">LENGTH</span><span class="p">(</span><span class="n">CITY</span><span class="p">),</span><span class="n">CITY</span>
<span class="k">LIMIT</span> <span class="mi">1</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="n">CITY</span><span class="p">,</span> <span class="k">LENGTH</span><span class="p">(</span><span class="n">CITY</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">STATION</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">LENGTH</span><span class="p">(</span><span class="n">CITY</span><span class="p">)</span> <span class="k">DESC</span><span class="p">,</span><span class="n">CITY</span>
<span class="k">LIMIT</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-11-"><span style="color:#4cbb17"> Bài 11: </span></h4>

<p><img src="https://i.imgur.com/g0mmEqi.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">CITY</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">CITY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'o'</span><span class="p">,</span><span class="s1">'u'</span><span class="p">,</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'E'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'O'</span><span class="p">,</span><span class="s1">'U'</span><span class="p">);</span> 
</code></pre></div></div>

<h4 id="-bài-12-"><span style="color:#4cbb17"> Bài 12: </span></h4>

<p><img src="https://i.imgur.com/JUyCT7r.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">CITY</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">CITY</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'o'</span><span class="p">,</span><span class="s1">'u'</span><span class="p">,</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'E'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'O'</span><span class="p">,</span><span class="s1">'U'</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="-bài-13-"><span style="color:#4cbb17"> Bài 13: </span></h4>

<p><img src="https://i.imgur.com/QbHRsoH.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">CITY</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">CITY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'o'</span><span class="p">,</span><span class="s1">'u'</span><span class="p">,</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'E'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'O'</span><span class="p">,</span><span class="s1">'U'</span><span class="p">)</span> <span class="k">AND</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">CITY</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'o'</span><span class="p">,</span><span class="s1">'u'</span><span class="p">,</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'E'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'O'</span><span class="p">,</span><span class="s1">'U'</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="-bài-14-"><span style="color:#4cbb17"> Bài 14: </span></h4>

<p><img src="https://i.imgur.com/JkxEf2p.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">CITY</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">CITY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'o'</span><span class="p">,</span><span class="s1">'u'</span><span class="p">,</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'E'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'O'</span><span class="p">,</span><span class="s1">'U'</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="-bài-15-"><span style="color:#4cbb17"> Bài 15: </span></h4>

<p><img src="https://i.imgur.com/OpaKV9X.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">CITY</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">CITY</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'o'</span><span class="p">,</span><span class="s1">'u'</span><span class="p">,</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'E'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'O'</span><span class="p">,</span><span class="s1">'U'</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="-harder-level-2--"><span style="color:RED"><em>** HARDER LEVEL 2: **</em> </span></h4>

<h4 id="-bài-16-"><span style="color:#4cbb17"> Bài 16: </span></h4>

<p><img src="https://i.imgur.com/Z5CkXqk.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">CITY</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">CITY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'o'</span><span class="p">,</span><span class="s1">'u'</span><span class="p">,</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'E'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'O'</span><span class="p">,</span><span class="s1">'U'</span><span class="p">)</span> <span class="k">OR</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">CITY</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'o'</span><span class="p">,</span><span class="s1">'u'</span><span class="p">,</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'E'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'O'</span><span class="p">,</span><span class="s1">'U'</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="-bài-17-"><span style="color:#4cbb17"> Bài 17: </span></h4>

<p><img src="https://i.imgur.com/kzkQZJg.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">CITY</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">CITY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'o'</span><span class="p">,</span><span class="s1">'u'</span><span class="p">,</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'E'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'O'</span><span class="p">,</span><span class="s1">'U'</span><span class="p">)</span> <span class="k">AND</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">CITY</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'o'</span><span class="p">,</span><span class="s1">'u'</span><span class="p">,</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'E'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'O'</span><span class="p">,</span><span class="s1">'U'</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="-bài-18-"><span style="color:#4cbb17"> Bài 18: </span></h4>

<p><img src="https://i.imgur.com/Hvoshzc.png" alt="Imgur" />
<img src="https://i.imgur.com/vhJl1ra.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">NAME</span> <span class="k">FROM</span> <span class="n">STUDENTS</span> <span class="k">WHERE</span> <span class="n">MARKS</span> <span class="o">&gt;</span> <span class="mi">75</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">RIGHT</span><span class="p">(</span><span class="n">NAME</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">ID</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-19-"><span style="color:#4cbb17"> Bài 19: </span></h4>

<p><img src="https://i.imgur.com/Tz13KJI.png" alt="Imgur" />
<img src="https://i.imgur.com/uU3vr7j.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">NAME</span> <span class="k">FROM</span> <span class="n">EMPLOYEE</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">NAME</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-20-"><span style="color:#4cbb17"> Bài 20: </span></h4>

<p><img src="https://i.imgur.com/X5oHJGr.png" alt="Imgur" />
<img src="https://i.imgur.com/62FS9gU.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">NAME</span> <span class="k">FROM</span> <span class="n">EMPLOYEE</span> <span class="k">WHERE</span> <span class="n">SALARY</span> <span class="o">&gt;</span> <span class="mi">2000</span> <span class="k">AND</span> <span class="n">MONTHS</span> <span class="o">&lt;</span> <span class="mi">10</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">EMPLOYEE_ID</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-harder-level-3--"><span style="color:RED"><em>** HARDER LEVEL 3: **</em> </span></h4>

<h4 id="-bài-21-"><span style="color:#4cbb17"> Bài 21: </span></h4>

<p><img src="https://i.imgur.com/L3w3Rff.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SET</span> <span class="o">@</span><span class="k">TEMP</span><span class="p">:</span><span class="o">=</span><span class="mi">21</span><span class="p">;</span> 
<span class="k">SELECT</span> <span class="n">REPEAT</span><span class="p">(</span><span class="s1">'* '</span><span class="p">,</span> <span class="o">@</span><span class="k">TEMP</span><span class="p">:</span><span class="o">=</span> <span class="o">@</span><span class="k">TEMP</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
<span class="k">FROM</span> <span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">TABLES</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-22-"><span style="color:#4cbb17"> Bài 22: </span></h4>

<p><img src="https://i.imgur.com/WP7vPKo.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SET</span> <span class="o">@</span><span class="k">TEMP</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> 
<span class="k">SELECT</span> <span class="n">REPEAT</span><span class="p">(</span><span class="s1">'* '</span><span class="p">,</span> <span class="o">@</span><span class="k">TEMP</span><span class="p">:</span><span class="o">=</span> <span class="o">@</span><span class="k">TEMP</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> 
<span class="k">FROM</span> <span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">TABLES</span>
<span class="k">WHERE</span> <span class="o">@</span><span class="k">TEMP</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-23-"><span style="color:#4cbb17"> Bài 23: </span></h4>

<p><img src="https://i.imgur.com/FybJXJk.png" alt="Imgur" />
<img src="https://i.imgur.com/HYRXkRL.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">CASE</span>
            <span class="k">WHEN</span> <span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">&gt;</span><span class="k">C</span> <span class="k">AND</span> <span class="n">B</span><span class="o">+</span><span class="k">C</span><span class="o">&gt;</span><span class="n">A</span> <span class="k">AND</span> <span class="n">A</span><span class="o">+</span><span class="k">C</span><span class="o">&gt;</span><span class="n">B</span> <span class="k">THEN</span>
                <span class="k">CASE</span>
                    <span class="k">WHEN</span> <span class="n">A</span><span class="o">=</span><span class="n">B</span> <span class="k">AND</span> <span class="n">B</span><span class="o">=</span><span class="k">C</span> <span class="k">THEN</span> <span class="s1">'Equilateral'</span>
                    <span class="k">WHEN</span> <span class="n">A</span><span class="o">=</span><span class="n">B</span> <span class="k">OR</span> <span class="n">B</span><span class="o">=</span><span class="k">C</span> <span class="k">OR</span> <span class="n">A</span><span class="o">=</span><span class="k">C</span> <span class="k">THEN</span> <span class="s1">'Isosceles'</span>
                    <span class="k">ELSE</span> <span class="s1">'Scalene'</span>
                <span class="k">END</span>
            <span class="k">ELSE</span> <span class="s1">'Not A Triangle'</span>
            <span class="k">END</span>
<span class="k">FROM</span> <span class="n">TRIANGLES</span><span class="p">;</span>
</code></pre></div></div>
<h4 id="-bài-24-"><span style="color:#4cbb17"> Bài 24: </span></h4>

<p><img src="https://i.imgur.com/rlqzZbq.png" alt="Imgur" />
<img src="https://i.imgur.com/HsifW2G.png" alt="Imgur" />
<img src="https://i.imgur.com/D14Xl7e.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">CONCAT</span><span class="p">(</span><span class="n">NAME</span><span class="p">,</span><span class="s1">'('</span><span class="p">,</span><span class="k">LEFT</span><span class="p">(</span><span class="n">OCCUPATION</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s1">')'</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">OCCUPATIONS</span> 
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">NAME</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="n">CONCAT</span><span class="p">(</span><span class="s1">'There are a total of '</span><span class="p">,</span><span class="k">COUNT</span><span class="p">(</span><span class="n">OCCUPATION</span><span class="p">),</span><span class="s1">' '</span><span class="p">,</span><span class="k">LOWER</span><span class="p">(</span><span class="n">OCCUPATION</span><span class="p">),</span><span class="s1">'s.'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TOTAL</span> <span class="k">FROM</span> <span class="n">OCCUPATIONS</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">OCCUPATION</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">TOTAL</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="--note--"><span style="color:#4cbb17"> <strong>*** Note **</strong>* </span></h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GROUP BY: Là sort lại và chỉ lấy cái đại diện thôi còn ORDER BY: thì cũng sắp xếp lại và lấy luôn những cái giống nhau !
</code></pre></div></div>

<h4 id="--bài-25-"><span style="color:#4cbb17"> (**) Bài 25: </span></h4>

<p><img src="https://i.imgur.com/5n7K5JR.png" alt="Imgur" />
<img src="https://i.imgur.com/MbmefDj.png" alt="Imgur" />
<img src="https://i.imgur.com/sj0JkSW.png" alt="Imgur" /></p>

<p>Solution: [Don’t see example because input not example]</p>

<p>** Step 1: **</p>

<p>Create a virtual table in your head of data given to us. It look like us:</p>

<p><img src="https://i.imgur.com/eBBn6CN.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Doctor'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Doctor</span><span class="p">,</span>
    <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Professor'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Professor</span><span class="p">,</span>
    <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Singer'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Singer</span><span class="p">,</span>
    <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Actor'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Actor</span>
<span class="k">FROM</span> <span class="n">OCCUPATIONS</span>
</code></pre></div></div>

<p>Explanation: <code class="language-plaintext highlighter-rouge">END AS</code> in <code class="language-plaintext highlighter-rouge">mysql</code></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">OrderID</span><span class="p">,</span> <span class="n">Quantity</span><span class="p">,</span>
<span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">Quantity</span> <span class="o">&gt;</span> <span class="mi">30</span> <span class="k">THEN</span> <span class="s1">'The quantity is greater than 30'</span>
<span class="k">WHEN</span> <span class="n">Quantity</span> <span class="o">=</span> <span class="mi">30</span> <span class="k">THEN</span> <span class="s1">'The quantity is 30'</span>
<span class="k">ELSE</span> <span class="s1">'The quantity is under 30'</span>
<span class="k">END</span> <span class="k">AS</span> <span class="n">QuantityText</span>
<span class="k">FROM</span> <span class="n">OrderDetails</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="https://i.imgur.com/80rZqet.png" alt="Imgur" /></p>

<p>** Step 2: **</p>

<p>Create an index column with respect to occupation as “RowNumber”</p>

<p><img src="https://i.imgur.com/PaC7sEQ.png" alt="Imgur" /></p>

<p>Notice from the image, under professor column, the first Name is indexed as 1, the next name “Birtney” as 2. That is what I mean by index w.r.t occupation.</p>

<p>The below code will only give the “RowNumber” column, to get the result like in image proceed to step 3</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set @r1=0, @r2=0, @r3=0, @r4=0;

SELECT case 
	when Occupation='Doctor' then (@r1:=@r1+1)
        when Occupation='Professor' then (@r2:=@r2+1)
        when Occupation='Singer' then (@r3:=@r3+1)
        when Occupation='Actor' then (@r4:=@r4+1) end as RowNumber

FROM OCCUPATIONS
</code></pre></div></div>

<p>** Step 3: **</p>

<p>Combine the result from step 1 and step 2:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">set</span> <span class="o">@</span><span class="n">r1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">@</span><span class="n">r2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">@</span><span class="n">r3</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">@</span><span class="n">r4</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="k">case</span> 
	<span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Doctor'</span> <span class="k">then</span> <span class="p">(</span><span class="o">@</span><span class="n">r1</span><span class="p">:</span><span class="o">=@</span><span class="n">r1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Professor'</span> <span class="k">then</span> <span class="p">(</span><span class="o">@</span><span class="n">r2</span><span class="p">:</span><span class="o">=@</span><span class="n">r2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Singer'</span> <span class="k">then</span> <span class="p">(</span><span class="o">@</span><span class="n">r3</span><span class="p">:</span><span class="o">=@</span><span class="n">r3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Actor'</span> <span class="k">then</span> <span class="p">(</span><span class="o">@</span><span class="n">r4</span><span class="p">:</span><span class="o">=@</span><span class="n">r4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">end</span> <span class="k">as</span> <span class="n">RowNumber</span><span class="p">,</span>
        <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Doctor'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Doctor</span><span class="p">,</span>
        <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Professor'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Professor</span><span class="p">,</span>
        <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Singer'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Singer</span><span class="p">,</span>
        <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Actor'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Actor</span>

<span class="k">FROM</span> <span class="n">OCCUPATIONS</span>

</code></pre></div></div>

<p>** Step 4: **</p>

<p>Now, Order_by name the Group_By RowNumber</p>

<p>Using Min/Max, if there is a name, it will return it, if not, return NULL.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">set</span> <span class="o">@</span><span class="n">r1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">@</span><span class="n">r2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">@</span><span class="n">r3</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">@</span><span class="n">r4</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="k">select</span> <span class="k">min</span><span class="p">(</span><span class="n">Doctor</span><span class="p">),</span> <span class="k">min</span><span class="p">(</span><span class="n">Professor</span><span class="p">),</span> <span class="k">min</span><span class="p">(</span><span class="n">Singer</span><span class="p">),</span> <span class="k">min</span><span class="p">(</span><span class="n">Actor</span><span class="p">)</span>
<span class="k">from</span><span class="p">(</span>
  <span class="k">select</span> <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Doctor'</span> <span class="k">then</span> <span class="p">(</span><span class="o">@</span><span class="n">r1</span><span class="p">:</span><span class="o">=@</span><span class="n">r1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Professor'</span> <span class="k">then</span> <span class="p">(</span><span class="o">@</span><span class="n">r2</span><span class="p">:</span><span class="o">=@</span><span class="n">r2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Singer'</span> <span class="k">then</span> <span class="p">(</span><span class="o">@</span><span class="n">r3</span><span class="p">:</span><span class="o">=@</span><span class="n">r3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Actor'</span> <span class="k">then</span> <span class="p">(</span><span class="o">@</span><span class="n">r4</span><span class="p">:</span><span class="o">=@</span><span class="n">r4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">end</span> <span class="k">as</span> <span class="n">RowNumber</span><span class="p">,</span>
    <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Doctor'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Doctor</span><span class="p">,</span>
    <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Professor'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Professor</span><span class="p">,</span>
    <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Singer'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Singer</span><span class="p">,</span>
    <span class="k">case</span> <span class="k">when</span> <span class="n">Occupation</span><span class="o">=</span><span class="s1">'Actor'</span> <span class="k">then</span> <span class="n">Name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">Actor</span>
  <span class="k">from</span> <span class="n">OCCUPATIONS</span>
  <span class="k">order</span> <span class="k">by</span> <span class="n">Name</span>
	<span class="p">)</span> <span class="k">temp</span>
<span class="k">group</span> <span class="k">by</span> <span class="n">RowNumber</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-25-"><span style="color:#4cbb17"> Bài 25: </span></h4>

<p><img src="https://i.imgur.com/KvKJ5R0.png" alt="Imgur" />
<img src="https://i.imgur.com/vrokwqr.png" alt="Imgur" />
<img src="https://i.imgur.com/N9uD7fk.png" alt="Imgur" />
<img src="https://i.imgur.com/Hj7oIc5.png" alt="Imgur" />
<img src="https://i.imgur.com/wHIQc8o.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">c</span><span class="p">.</span><span class="n">company_code</span><span class="p">,</span> <span class="k">c</span><span class="p">.</span><span class="n">founder</span><span class="p">,</span> 
    <span class="k">count</span><span class="p">(</span><span class="k">distinct</span> <span class="n">l</span><span class="p">.</span><span class="n">lead_manager_code</span><span class="p">),</span> <span class="k">count</span><span class="p">(</span><span class="k">distinct</span> <span class="n">s</span><span class="p">.</span><span class="n">senior_manager_code</span><span class="p">),</span> 
    <span class="k">count</span><span class="p">(</span><span class="k">distinct</span> <span class="n">m</span><span class="p">.</span><span class="n">manager_code</span><span class="p">),</span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span> <span class="n">e</span><span class="p">.</span><span class="n">employee_code</span><span class="p">)</span> 
<span class="k">from</span> <span class="n">Company</span> <span class="k">c</span><span class="p">,</span> <span class="n">Lead_Manager</span> <span class="n">l</span><span class="p">,</span> <span class="n">Senior_Manager</span> <span class="n">s</span><span class="p">,</span> <span class="n">Manager</span> <span class="n">m</span><span class="p">,</span> <span class="n">Employee</span> <span class="n">e</span> 
<span class="k">where</span> <span class="k">c</span><span class="p">.</span><span class="n">company_code</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="n">company_code</span> 
    <span class="k">and</span> <span class="n">l</span><span class="p">.</span><span class="n">lead_manager_code</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">lead_manager_code</span> 
    <span class="k">and</span> <span class="n">s</span><span class="p">.</span><span class="n">senior_manager_code</span><span class="o">=</span><span class="n">m</span><span class="p">.</span><span class="n">senior_manager_code</span> 
    <span class="k">and</span> <span class="n">m</span><span class="p">.</span><span class="n">manager_code</span><span class="o">=</span><span class="n">e</span><span class="p">.</span><span class="n">manager_code</span> 
<span class="k">group</span> <span class="k">by</span> <span class="k">c</span><span class="p">.</span><span class="n">company_code</span><span class="p">,</span> <span class="k">c</span><span class="p">.</span><span class="n">founder</span> 
<span class="k">order</span> <span class="k">by</span> <span class="k">c</span><span class="p">.</span><span class="n">company_code</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-super-hard-join"><span style="color:Red"> Super Hard (Join)</span></h4>

<h4 id="-bài-26-"><span style="color:#4cbb17"> Bài 26: </span></h4>

<p><img src="https://i.imgur.com/Y6n05lk.png" alt="Imgur" />
<img src="https://i.imgur.com/BotlVG9.png" alt="Imgur" />
<img src="https://i.imgur.com/7lrlAlC.png" alt="Imgur" />
<img src="https://i.imgur.com/l4rZ7mo.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">h</span><span class="p">.</span><span class="n">hacker_id</span><span class="p">,</span> <span class="n">h</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">t1</span><span class="p">.</span><span class="n">total_score</span>
<span class="k">FROM</span><span class="p">(</span> 
    <span class="k">SELECT</span> <span class="n">hacker_id</span><span class="p">,</span> <span class="k">SUM</span><span class="p">(</span><span class="n">max_score</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_score</span>
    <span class="k">FROM</span><span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">hacker_id</span><span class="p">,</span> <span class="k">MAX</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">AS</span> <span class="n">max_score</span>
        <span class="k">FROM</span> <span class="n">Submissions</span>
        <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">hacker_id</span><span class="p">,</span> <span class="n">challenge_id</span>
    <span class="p">)</span> <span class="n">t</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">hacker_id</span>
<span class="p">)</span> <span class="n">t1</span>
<span class="k">JOIN</span> <span class="n">Hackers</span> <span class="n">h</span> 
<span class="k">ON</span> <span class="n">h</span><span class="p">.</span><span class="n">hacker_id</span> <span class="o">=</span> <span class="n">t1</span><span class="p">.</span><span class="n">hacker_id</span> 
<span class="k">WHERE</span> <span class="n">t1</span><span class="p">.</span><span class="n">total_score</span> <span class="o">&lt;&gt;</span><span class="mi">0</span> 
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">total_score</span> <span class="k">DESC</span><span class="p">,</span> <span class="n">hacker_id</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-27-"><span style="color:#4cbb17"> Bài 27: </span></h4>

<p><img src="https://i.imgur.com/VHWrYaS.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ROUND</span><span class="p">(</span><span class="n">LONG_W</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">STATION</span>
<span class="k">WHERE</span> <span class="n">LAT_N</span> <span class="o">=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">MIN</span><span class="p">(</span><span class="n">LAT_N</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="n">LAT_N</span> <span class="o">&gt;</span><span class="mi">38</span><span class="p">.</span><span class="mi">7780</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="-bài-28-"><span style="color:#4cbb17"> Bài 28: </span></h4>

<p><img src="https://i.imgur.com/TjXHJyO.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> 
    <span class="n">ROUND</span><span class="p">(</span><span class="k">ABS</span><span class="p">(</span><span class="k">MAX</span><span class="p">(</span><span class="n">LAT_N</span><span class="p">)</span><span class="o">-</span><span class="k">MIN</span><span class="p">(</span><span class="n">LAT_N</span><span class="p">))</span><span class="o">+</span><span class="k">ABS</span><span class="p">(</span><span class="k">MAX</span><span class="p">(</span><span class="n">LONG_W</span><span class="p">)</span><span class="o">-</span><span class="k">MIN</span><span class="p">(</span><span class="n">LONG_W</span><span class="p">)),</span><span class="mi">4</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">STATION</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-29-"><span style="color:#4cbb17"> Bài 29: </span></h4>

<p><img src="https://i.imgur.com/cTGYVOt.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> 
    <span class="n">round</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span>
        <span class="n">power</span><span class="p">((</span><span class="k">max</span><span class="p">(</span><span class="n">LAT_N</span><span class="p">)</span><span class="o">-</span><span class="k">min</span><span class="p">(</span><span class="n">LAT_N</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> 
        <span class="n">power</span><span class="p">((</span><span class="k">max</span><span class="p">(</span><span class="n">LONG_W</span><span class="p">)</span><span class="o">-</span><span class="k">min</span><span class="p">(</span><span class="n">LONG_W</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">),</span><span class="mi">4</span><span class="p">)</span>
<span class="k">from</span> <span class="n">STATION</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-30-"><span style="color:#4cbb17"> Bài 30: </span></h4>

<p><img src="https://i.imgur.com/kGMA0IG.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Select</span> <span class="n">round</span><span class="p">(</span><span class="n">S</span><span class="p">.</span><span class="n">LAT_N</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="k">from</span> <span class="n">station</span> <span class="k">AS</span> <span class="n">S</span> <span class="k">where</span> <span class="p">(</span><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="n">Lat_N</span><span class="p">)</span> <span class="k">from</span> <span class="n">station</span> <span class="k">where</span> <span class="n">Lat_N</span> <span class="o">&lt;</span> <span class="n">S</span><span class="p">.</span><span class="n">LAT_N</span> <span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="n">Lat_N</span><span class="p">)</span> <span class="k">from</span> <span class="n">station</span> <span class="k">where</span> <span class="n">Lat_N</span> <span class="o">&gt;</span> <span class="n">S</span><span class="p">.</span><span class="n">LAT_N</span><span class="p">);</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Note: AS là dùng để viết tắt tên bảng khi tên bảng dài quá, và dùng S.LAT_N là để đối tượng đang được nhắc tới !
</code></pre></div></div>

<h4 id="-bài-31-"><span style="color:#4cbb17"> Bài 31: </span></h4>

<p><img src="https://i.imgur.com/tOd4z9D.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ROUND</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="n">POPULATION</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">CITY</span><span class="p">;</span>
</code></pre></div></div>
<h4 id="-bài-32-"><span style="color:#4cbb17"> Bài 32: </span></h4>

<p><img src="https://i.imgur.com/iMeIsPN.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">sum</span><span class="p">(</span><span class="n">population</span><span class="p">)</span> <span class="k">from</span> <span class="n">city</span> <span class="k">where</span> <span class="n">countrycode</span> <span class="o">=</span> <span class="nv">"JPN"</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-33-"><span style="color:#4cbb17"> Bài 33: </span></h4>

<p><img src="https://i.imgur.com/nBUQA1y.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">abs</span><span class="p">(</span><span class="k">max</span><span class="p">(</span><span class="n">population</span><span class="p">)</span><span class="o">-</span><span class="k">min</span><span class="p">(</span><span class="n">population</span><span class="p">))</span> <span class="k">from</span> <span class="n">city</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-34-"><span style="color:#4cbb17"> Bài 34: </span></h4>

<p><img src="https://i.imgur.com/mseiUxa.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="n">population</span><span class="p">)</span> <span class="k">from</span> <span class="n">CITY</span> <span class="k">where</span> <span class="n">population</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-35-"><span style="color:#4cbb17"> Bài 35: </span></h4>

<p><img src="https://i.imgur.com/QluKPM7.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">sum</span><span class="p">(</span><span class="n">population</span><span class="p">)</span> <span class="k">from</span> <span class="n">city</span> <span class="k">where</span> <span class="n">district</span> <span class="o">=</span> <span class="nv">"California"</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-36-"><span style="color:#4cbb17"> Bài 36: </span></h4>

<p><img src="https://i.imgur.com/zeyDzpC.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">avg</span><span class="p">(</span><span class="n">population</span><span class="p">)</span> <span class="k">from</span> <span class="n">city</span> <span class="k">where</span> <span class="n">district</span> <span class="o">=</span> <span class="nv">"California"</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-37-"><span style="color:#4cbb17"> Bài 37: </span></h4>

<p><img src="https://i.imgur.com/29MQvhp.png" alt="Imgur" />
<img src="https://i.imgur.com/7CK3Sid.png" alt="Imgur" />
<img src="https://i.imgur.com/t4lTT5N.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">ceil</span><span class="p">(</span><span class="k">avg</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span><span class="o">-</span><span class="k">avg</span><span class="p">(</span><span class="k">replace</span><span class="p">(</span><span class="n">salary</span><span class="p">,</span><span class="s1">'0'</span><span class="p">,</span><span class="s1">''</span><span class="p">)))</span> <span class="k">from</span> <span class="n">employees</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-38-"><span style="color:#4cbb17"> Bài 38: </span></h4>

<p><img src="https://i.imgur.com/UGbw19M.png" alt="Imgur" />
<img src="https://i.imgur.com/bPFG0zR.png" alt="Imgur" />
<img src="https://i.imgur.com/Q3zpuyT.png" alt="Imgur" /></p>

<pre><code class="language-txt">salary*month --- first to calculate total earnings we multiply month * salary

count() -- next for counting no of employees having that salary we use count()

group by 1 -- ill take simple example..consider query SELECT name , id FROM employee group by 1; in this query there are 2 columns i.e., name and id...So we have to group it by 1st column that is name.

order by earning desc -- it will order the table in desc order do that max value appears frst.

limit 1 -- it will limit the table to 1 row only. so the query displays the frst row only.
</code></pre>

<p><img src="https://i.imgur.com/bUZWxVA.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="p">(</span><span class="n">salary</span><span class="o">*</span><span class="n">months</span><span class="p">)</span> <span class="k">as</span> <span class="n">earnings</span> <span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">from</span> <span class="n">employee</span> <span class="k">group</span> <span class="k">by</span> <span class="mi">1</span> <span class="k">order</span> <span class="k">by</span> <span class="n">earnings</span>
<span class="k">desc</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-39-"><span style="color:#4cbb17"> Bài 39: </span></h4>

<p><img src="https://i.imgur.com/F8VOkAD.png" alt="Imgur" />
<img src="https://i.imgur.com/4GMfF0N.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> 
    <span class="n">ROUND</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">LAT_N</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">ROUND</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">LONG_W</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> 
<span class="k">FROM</span> <span class="n">STATION</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-40-"><span style="color:#4cbb17"> Bài 40: </span></h4>

<p><img src="https://i.imgur.com/1ESoOC1.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ROUND</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">LAT_N</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="mi">38</span><span class="p">.</span><span class="mi">7880</span><span class="o">&lt;</span> <span class="n">LAT_N</span> <span class="k">AND</span> <span class="n">LAT_N</span> <span class="o">&lt;</span> <span class="mi">137</span><span class="p">.</span><span class="mi">2345</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-41-"><span style="color:#4cbb17"> Bài 41: </span></h4>

<p><img src="https://i.imgur.com/2js7pPo.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">round</span><span class="p">(</span><span class="k">max</span><span class="p">(</span><span class="n">LAT_N</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span> <span class="k">from</span> <span class="n">station</span> <span class="k">where</span> <span class="n">LAT_N</span> <span class="o">&lt;</span> <span class="mi">137</span><span class="p">.</span><span class="mi">2345</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-42-"><span style="color:#4cbb17"> Bài 42: </span></h4>

<p><img src="https://i.imgur.com/Bw5mLhX.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">round</span><span class="p">(</span><span class="n">LONG_W</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="k">from</span> <span class="n">STATION</span> <span class="k">where</span> <span class="n">LAT_N</span> <span class="o">=</span> <span class="p">(</span><span class="k">select</span> <span class="k">MAX</span><span class="p">(</span><span class="n">LAT_N</span><span class="p">)</span> <span class="k">from</span> <span class="n">STATION</span> <span class="k">where</span> <span class="n">LAT_N</span><span class="o">&lt;</span><span class="mi">137</span><span class="p">.</span><span class="mi">2345</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="-bài-43-"><span style="color:#4cbb17"> Bài 43: </span></h4>

<p><img src="https://i.imgur.com/pCNROM7.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ROUND</span><span class="p">(</span><span class="n">LAT_N</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="n">LAT_N</span> <span class="o">=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">MIN</span><span class="p">(</span><span class="n">LAT_N</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">STATION</span> <span class="k">WHERE</span> <span class="n">LAT_N</span><span class="o">&gt;</span><span class="mi">38</span><span class="p">.</span><span class="mi">7780</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="-bài-44-"><span style="color:#4cbb17"> Bài 44: </span></h4>

<p><img src="https://i.imgur.com/9KCeSy5.png" alt="Imgur" />
<img src="https://i.imgur.com/bdMXyWW.png" alt="Imgur" />
<img src="https://i.imgur.com/iTLjx3T.png" alt="Imgur" />
<img src="https://i.imgur.com/cdfJtbA.png" alt="Imgur" />
<img src="https://i.imgur.com/ObkANby.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">W</span><span class="p">.</span><span class="n">ID</span><span class="p">,</span> <span class="n">P</span><span class="p">.</span><span class="n">AGE</span><span class="p">,</span> <span class="n">W</span><span class="p">.</span><span class="n">COINS_NEEDED</span><span class="p">,</span> <span class="n">W</span><span class="p">.</span><span class="n">POWER</span> 
<span class="k">FROM</span> <span class="n">WANDS</span> <span class="k">AS</span> <span class="n">W</span>
<span class="k">JOIN</span> <span class="n">WANDS_PROPERTY</span> <span class="k">AS</span> <span class="n">P</span>
<span class="k">ON</span> <span class="p">(</span><span class="n">W</span><span class="p">.</span><span class="n">CODE</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">CODE</span><span class="p">)</span>
<span class="k">WHERE</span> <span class="n">P</span><span class="p">.</span><span class="n">IS_EVIL</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">AND</span> <span class="n">W</span><span class="p">.</span><span class="n">COINS_NEEDED</span> <span class="o">=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">MIN</span><span class="p">(</span><span class="n">COINS_NEEDED</span><span class="p">)</span>
                                         <span class="k">FROM</span> <span class="n">WANDS</span> <span class="k">AS</span> <span class="n">X</span>
                                         <span class="k">JOIN</span> <span class="n">WANDS_PROPERTY</span> <span class="k">AS</span> <span class="n">Y</span>
                                         <span class="k">ON</span> <span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">CODE</span> <span class="o">=</span> <span class="n">Y</span><span class="p">.</span><span class="n">CODE</span><span class="p">)</span>
                                         <span class="k">WHERE</span> <span class="n">X</span><span class="p">.</span><span class="n">POWER</span> <span class="o">=</span> <span class="n">W</span><span class="p">.</span><span class="n">POWER</span> <span class="k">AND</span> <span class="n">Y</span><span class="p">.</span><span class="n">AGE</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">AGE</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">W</span><span class="p">.</span><span class="n">POWER</span> <span class="k">DESC</span><span class="p">,</span> <span class="n">P</span><span class="p">.</span><span class="n">AGE</span> <span class="k">DESC</span><span class="p">;</span>  
</code></pre></div></div>

<h4 id="-bài-44--1"><span style="color:#4cbb17"> Bài 44: </span></h4>

<p><img src="https://i.imgur.com/1Yc6daG.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">SUM</span><span class="p">(</span><span class="n">CITY</span><span class="p">.</span><span class="n">POPULATION</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">CITY</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">COUNTRY</span> 
<span class="k">ON</span> <span class="n">CITY</span><span class="p">.</span><span class="n">COUNTRYCODE</span> <span class="o">=</span> <span class="n">COUNTRY</span><span class="p">.</span><span class="n">CODE</span> 
<span class="k">WHERE</span> <span class="n">COUNTRY</span><span class="p">.</span><span class="n">CONTINENT</span> <span class="o">=</span> <span class="s1">'Asia'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-45-"><span style="color:#4cbb17"> Bài 45: </span></h4>

<p><img src="https://i.imgur.com/UOvK4ZT.png" alt="Imgur" />
<img src="https://i.imgur.com/w8lcI4j.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">CITY</span><span class="p">.</span><span class="n">NAME</span> <span class="k">FROM</span> <span class="n">CITY</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">COUNTRY</span>
<span class="k">ON</span> <span class="n">CITY</span><span class="p">.</span><span class="n">COUNTRYCODE</span> <span class="o">=</span> <span class="n">COUNTRY</span><span class="p">.</span><span class="n">CODE</span> 
<span class="k">WHERE</span> <span class="n">COUNTRY</span><span class="p">.</span><span class="n">CONTINENT</span> <span class="o">=</span> <span class="s1">'Africa'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-46-"><span style="color:#4cbb17"> Bài 46: </span></h4>

<p><img src="https://i.imgur.com/LMkjt4Y.png" alt="Imgur" />
<img src="https://i.imgur.com/6p2jVDC.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">COUNTRY</span><span class="p">.</span><span class="n">CONTINENT</span><span class="p">,</span> <span class="n">FLOOR</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="n">CITY</span><span class="p">.</span><span class="n">POPULATION</span><span class="p">))</span>
<span class="k">FROM</span> <span class="n">COUNTRY</span><span class="p">,</span> <span class="n">CITY</span>
<span class="k">WHERE</span> <span class="n">COUNTRY</span><span class="p">.</span><span class="n">CODE</span> <span class="o">=</span> <span class="n">CITY</span><span class="p">.</span><span class="n">COUNTRYCODE</span> 
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">COUNTRY</span><span class="p">.</span><span class="n">CONTINENT</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-47-"><span style="color:#4cbb17"> Bài 47: </span></h4>

<p><img src="https://i.imgur.com/mnUHSwK.png" alt="Imgur" />
<img src="https://i.imgur.com/NQ6mRHx.png" alt="Imgur" />
<img src="https://i.imgur.com/eRCSCrq.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">IF</span><span class="p">(</span><span class="n">GRADES</span><span class="p">.</span><span class="n">GRADE</span><span class="o">&gt;=</span><span class="mi">8</span><span class="p">,</span><span class="n">STUDENTS</span><span class="p">.</span><span class="n">NAME</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span> <span class="n">GRADES</span><span class="p">.</span><span class="n">GRADE</span><span class="p">,</span> <span class="n">STUDENTS</span><span class="p">.</span><span class="n">MARKS</span>
<span class="k">FROM</span> <span class="n">GRADES</span><span class="p">,</span> <span class="n">STUDENTS</span> 
<span class="k">WHERE</span> <span class="n">STUDENTS</span><span class="p">.</span><span class="n">MARKS</span> <span class="k">BETWEEN</span> <span class="n">GRADES</span><span class="p">.</span><span class="n">MIN_MARK</span> <span class="k">AND</span> <span class="n">GRADES</span><span class="p">.</span><span class="n">MAX_MARK</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">GRADES</span><span class="p">.</span><span class="n">GRADE</span> <span class="k">DESC</span><span class="p">,</span> <span class="n">STUDENTS</span><span class="p">.</span><span class="n">NAME</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-48-"><span style="color:#4cbb17"> Bài 48: </span></h4>

<p><img src="https://i.imgur.com/lhu1Gy0.png" alt="Imgur" />
<img src="https://i.imgur.com/BbymX7a.png" alt="Imgur" />
<img src="https://i.imgur.com/XobDELW.png" alt="Imgur" />
<img src="https://i.imgur.com/7eVd1Q8.png" alt="Imgur" />
<img src="https://i.imgur.com/OMMnE6o.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">H</span><span class="p">.</span><span class="n">HACKER_ID</span><span class="p">,</span> <span class="n">H</span><span class="p">.</span><span class="n">NAME</span>
<span class="k">FROM</span> <span class="n">HACKERS</span> <span class="n">H</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">SUBMISSIONS</span> <span class="n">S</span>
<span class="k">ON</span> <span class="n">H</span><span class="p">.</span><span class="n">HACKER_ID</span> <span class="o">=</span> <span class="n">S</span><span class="p">.</span><span class="n">HACKER_ID</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">CHALLENGES</span> <span class="k">C</span>
<span class="k">ON</span> <span class="n">S</span><span class="p">.</span><span class="n">CHALLENGE_ID</span> <span class="o">=</span> <span class="k">C</span><span class="p">.</span><span class="n">CHALLENGE_ID</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">DIFFICULTY</span> <span class="n">D</span>
<span class="k">ON</span> <span class="k">C</span><span class="p">.</span><span class="n">DIFFICULTY_LEVEL</span> <span class="o">=</span> <span class="n">D</span><span class="p">.</span><span class="n">DIFFICULTY_LEVEL</span>
<span class="k">WHERE</span> <span class="n">S</span><span class="p">.</span><span class="n">SCORE</span> <span class="o">=</span> <span class="n">D</span><span class="p">.</span><span class="n">SCORE</span> <span class="k">AND</span> <span class="k">C</span><span class="p">.</span><span class="n">DIFFICULTY_LEVEL</span> <span class="o">=</span> <span class="n">D</span><span class="p">.</span><span class="n">DIFFICULTY_LEVEL</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">H</span><span class="p">.</span><span class="n">HACKER_ID</span><span class="p">,</span> <span class="n">H</span><span class="p">.</span><span class="n">NAME</span>
<span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">S</span><span class="p">.</span><span class="n">HACKER_ID</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">S</span><span class="p">.</span><span class="n">HACKER_ID</span><span class="p">)</span> <span class="k">DESC</span><span class="p">,</span> <span class="n">S</span><span class="p">.</span><span class="n">HACKER_ID</span> <span class="k">ASC</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-49-"><span style="color:#4cbb17"> Bài 49: </span></h4>

<p><img src="https://i.imgur.com/9UIrgW7.png" alt="Imgur" />
<img src="https://i.imgur.com/DrSRBnf.png" alt="Imgur" />
<img src="https://i.imgur.com/CDsRqsj.png" alt="Imgur" />
<img src="https://i.imgur.com/Q4XTmC3.png" alt="Imgur" />
<img src="https://i.imgur.com/C20bDab.png" alt="Imgur" />
<img src="https://i.imgur.com/9Y6ptBq.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">H</span><span class="p">.</span><span class="n">HACKER_ID</span><span class="p">,</span> 
       <span class="n">H</span><span class="p">.</span><span class="n">NAME</span><span class="p">,</span> 
       <span class="k">COUNT</span><span class="p">(</span><span class="k">C</span><span class="p">.</span><span class="n">CHALLENGE_ID</span><span class="p">)</span> <span class="k">AS</span> <span class="n">C_COUNT</span>
<span class="k">FROM</span> <span class="n">HACKERS</span> <span class="n">H</span>
<span class="k">JOIN</span> <span class="n">CHALLENGES</span> <span class="k">C</span> <span class="k">ON</span> <span class="k">C</span><span class="p">.</span><span class="n">HACKER_ID</span> <span class="o">=</span> <span class="n">H</span><span class="p">.</span><span class="n">HACKER_ID</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">H</span><span class="p">.</span><span class="n">HACKER_ID</span><span class="p">,</span> <span class="n">H</span><span class="p">.</span><span class="n">NAME</span>
<span class="k">HAVING</span> <span class="n">C_COUNT</span> <span class="o">=</span> 
    <span class="p">(</span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">C2</span><span class="p">.</span><span class="n">CHALLENGE_ID</span><span class="p">)</span> <span class="k">AS</span> <span class="n">C_MAX</span>
     <span class="k">FROM</span> <span class="n">CHALLENGES</span> <span class="k">AS</span> <span class="n">C2</span>
     <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">C2</span><span class="p">.</span><span class="n">HACKER_ID</span> 
     <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">C_MAX</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">OR</span> <span class="n">C_COUNT</span> <span class="k">IN</span> 
    <span class="p">(</span><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">C_COMPARE</span> <span class="k">AS</span> <span class="n">C_UNIQUE</span>
     <span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">H2</span><span class="p">.</span><span class="n">HACKER_ID</span><span class="p">,</span> 
                  <span class="n">H2</span><span class="p">.</span><span class="n">NAME</span><span class="p">,</span> 
                  <span class="k">COUNT</span><span class="p">(</span><span class="n">CHALLENGE_ID</span><span class="p">)</span> <span class="k">AS</span> <span class="n">C_COMPARE</span>
           <span class="k">FROM</span> <span class="n">HACKERS</span> <span class="n">H2</span>
           <span class="k">JOIN</span> <span class="n">CHALLENGES</span> <span class="k">C</span> <span class="k">ON</span> <span class="k">C</span><span class="p">.</span><span class="n">HACKER_ID</span> <span class="o">=</span> <span class="n">H2</span><span class="p">.</span><span class="n">HACKER_ID</span>
           <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">H2</span><span class="p">.</span><span class="n">HACKER_ID</span><span class="p">,</span> <span class="n">H2</span><span class="p">.</span><span class="n">NAME</span><span class="p">)</span> <span class="n">COUNTS</span>
     <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">C_COMPARE</span>
     <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">C_COMPARE</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">C_COUNT</span> <span class="k">DESC</span><span class="p">,</span> <span class="n">H</span><span class="p">.</span><span class="n">HACKER_ID</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-50-"><span style="color:#4cbb17"> Bài 50: </span></h4>
<p><img src="https://i.imgur.com/jOEzWjc.png" alt="Imgur" />
<img src="https://i.imgur.com/J9j0gM2.png" alt="Imgur" />
<img src="https://i.imgur.com/Svm9ndw.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- solution 1</span>
<span class="k">SET</span> <span class="o">@</span><span class="n">project</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">SET</span> <span class="o">@</span><span class="n">last_date</span> <span class="o">=</span> <span class="k">NULL</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="k">MIN</span><span class="p">(</span><span class="n">start_date</span><span class="p">),</span> <span class="k">MAX</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span>
            <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span>
            <span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">start_date</span> <span class="o">=</span> <span class="o">@</span><span class="n">last_date</span> <span class="k">THEN</span> <span class="o">@</span><span class="n">project</span>
                  <span class="k">ELSE</span> <span class="o">@</span><span class="n">project</span><span class="p">:</span><span class="o">=@</span><span class="n">project</span><span class="o">+</span><span class="mi">1</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">project</span><span class="p">,</span>
            <span class="o">@</span><span class="n">last_date</span><span class="p">:</span><span class="o">=</span><span class="n">end_date</span>
            <span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span> <span class="k">FROM</span> <span class="n">projects</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">start_date</span><span class="p">)</span> <span class="n">sorted</span><span class="p">)</span> <span class="k">temp</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">project</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="k">MIN</span><span class="p">(</span><span class="n">start_date</span><span class="p">);</span>
<span class="c1">-- Solution 2</span>
<span class="k">SELECT</span> <span class="n">start_date</span><span class="p">,</span> <span class="k">MIN</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">start_date</span> <span class="k">FROM</span> <span class="n">projects</span>
      <span class="k">WHERE</span> <span class="n">start_date</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">end_date</span> <span class="k">FROM</span> <span class="n">projects</span><span class="p">))</span> <span class="n">a</span>
      <span class="k">INNER</span> <span class="k">JOIN</span>
     <span class="p">(</span><span class="k">SELECT</span> <span class="n">end_date</span> <span class="k">FROM</span> <span class="n">projects</span>
      <span class="k">WHERE</span> <span class="n">end_date</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">start_date</span> <span class="k">FROM</span> <span class="n">projects</span><span class="p">))</span> <span class="n">b</span>
<span class="k">WHERE</span> <span class="n">start_date</span> <span class="o">&lt;</span> <span class="n">end_date</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">start_date</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">MIN</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span> <span class="o">-</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">start_date</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-51-"><span style="color:#4cbb17"> Bài 51: </span></h4>

<p><img src="https://i.imgur.com/ZA7fAws.png" alt="Imgur" />
<img src="https://i.imgur.com/wByAP51.png" alt="Imgur" />
<img src="https://i.imgur.com/uwATlwZ.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">S</span><span class="p">.</span><span class="n">NAME</span> 
<span class="k">FROM</span> <span class="n">STUDENTS</span> <span class="n">S</span>
<span class="k">JOIN</span> <span class="n">FRIENDS</span> <span class="n">F</span> <span class="k">ON</span> <span class="n">S</span><span class="p">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="n">ID</span> 
<span class="k">JOIN</span> <span class="n">PACKAGES</span> <span class="n">P1</span> <span class="k">ON</span> <span class="n">S</span><span class="p">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">P1</span><span class="p">.</span><span class="n">ID</span>
<span class="k">JOIN</span> <span class="n">PACKAGES</span> <span class="n">P2</span> <span class="k">ON</span> <span class="n">F</span><span class="p">.</span><span class="n">FRIEND_ID</span> <span class="o">=</span> <span class="n">P2</span><span class="p">.</span><span class="n">ID</span> 
<span class="k">WHERE</span> <span class="n">P2</span><span class="p">.</span><span class="n">SALARY</span> <span class="o">&gt;</span> <span class="n">P1</span><span class="p">.</span><span class="n">SALARY</span> 
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">P2</span><span class="p">.</span><span class="n">SALARY</span> 
</code></pre></div></div>

<h4 id="-bài-52-"><span style="color:#4cbb17"> Bài 52: </span></h4>

<p><img src="https://i.imgur.com/Q0K81V8.png" alt="Imgur" />
<img src="https://i.imgur.com/et80bx1.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="k">FROM</span> <span class="n">FUNCTIONS</span> <span class="n">F1</span>
    <span class="k">WHERE</span> <span class="k">EXISTS</span><span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">FUNCTIONS</span> <span class="n">F2</span> <span class="k">WHERE</span> <span class="n">F2</span><span class="p">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">F1</span><span class="p">.</span><span class="n">X</span>
    <span class="k">AND</span> <span class="n">F2</span><span class="p">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">F1</span><span class="p">.</span><span class="n">Y</span> <span class="k">AND</span> <span class="n">F2</span><span class="p">.</span><span class="n">X</span> <span class="o">&gt;</span> <span class="n">F1</span><span class="p">.</span><span class="n">X</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span><span class="n">X</span> <span class="o">!=</span> <span class="n">Y</span><span class="p">)</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="k">FROM</span> <span class="n">FUNCTIONS</span> <span class="n">F1</span> <span class="k">WHERE</span> <span class="n">X</span> <span class="o">=</span> <span class="n">Y</span> <span class="k">AND</span> 
    <span class="p">((</span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">FUNCTIONS</span> <span class="k">WHERE</span> <span class="n">X</span> <span class="o">=</span> <span class="n">F1</span><span class="p">.</span><span class="n">X</span> <span class="k">AND</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">F1</span><span class="p">.</span><span class="n">X</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
      <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">X</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-53-"><span style="color:#4cbb17">(**) Bài 53: </span></h4>

<p><img src="https://i.imgur.com/XgnOvnU.png" alt="Imgur" />
<img src="https://i.imgur.com/o6RxUQR.png" alt="Imgur" />
<img src="https://i.imgur.com/irPfzmO.png" alt="Imgur" />
<img src="https://i.imgur.com/1jUmtED.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
Working Platform:- MySQL
*/</span>
<span class="k">SELECT</span> <span class="n">A</span><span class="p">.</span><span class="n">CONTEST_ID</span><span class="p">,</span> <span class="n">A</span><span class="p">.</span><span class="n">HACKER_ID</span><span class="p">,</span> <span class="n">A</span><span class="p">.</span><span class="n">NAME</span><span class="p">,</span> 
        <span class="k">SUM</span><span class="p">(</span><span class="n">TOTAL_SUBMISSIONS</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TOTAL_SUBMISSIONS</span><span class="p">,</span> 
        <span class="k">SUM</span><span class="p">(</span><span class="n">TOTAL_ACCEPTED_SUBMISSIONS</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TOTAL_ACCEPTED_SUBMISSIONS</span><span class="p">,</span>
        <span class="k">SUM</span><span class="p">(</span><span class="n">TOTAL_VIEWS</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TOTAL_VIEWS</span><span class="p">,</span>
        <span class="k">SUM</span><span class="p">(</span><span class="n">TOTAL_UNIQUE_VIEWS</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TOTAL_UNIQUE_VIEWS</span>
<span class="k">FROM</span> <span class="n">CONTESTS</span> <span class="k">AS</span> <span class="n">A</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">COLLEGES</span> <span class="k">AS</span> <span class="n">B</span>
    <span class="k">ON</span> <span class="n">A</span><span class="p">.</span><span class="n">CONTEST_ID</span> <span class="o">=</span> <span class="n">B</span><span class="p">.</span><span class="n">CONTEST_ID</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">CHALLENGES</span> <span class="k">AS</span> <span class="k">C</span>
    <span class="k">ON</span> <span class="n">B</span><span class="p">.</span><span class="n">COLLEGE_ID</span> <span class="o">=</span> <span class="k">C</span><span class="p">.</span><span class="n">COLLEGE_ID</span> 
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">CHALLENGE_ID</span><span class="p">,</span> <span class="k">SUM</span><span class="p">(</span><span class="n">TOTAL_VIEWS</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TOTAL_VIEWS</span><span class="p">,</span> 
                  <span class="k">SUM</span><span class="p">(</span><span class="n">TOTAL_UNIQUE_VIEWS</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TOTAL_UNIQUE_VIEWS</span>
           <span class="k">FROM</span> <span class="n">VIEW_STATS</span>
           <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">CHALLENGE_ID</span><span class="p">)</span> <span class="k">AS</span> <span class="n">D</span> 
    <span class="k">ON</span> <span class="k">C</span><span class="p">.</span><span class="n">CHALLENGE_ID</span> <span class="o">=</span> <span class="n">D</span><span class="p">.</span><span class="n">CHALLENGE_ID</span> 
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">CHALLENGE_ID</span><span class="p">,</span> <span class="k">SUM</span><span class="p">(</span><span class="n">TOTAL_SUBMISSIONS</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TOTAL_SUBMISSIONS</span><span class="p">,</span> 
                  <span class="k">SUM</span><span class="p">(</span><span class="n">TOTAL_ACCEPTED_SUBMISSIONS</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TOTAL_ACCEPTED_SUBMISSIONS</span>
           <span class="k">FROM</span> <span class="n">SUBMISSION_STATS</span>
           <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">CHALLENGE_ID</span><span class="p">)</span> <span class="k">AS</span> <span class="n">E</span>
    <span class="k">ON</span> <span class="k">C</span><span class="p">.</span><span class="n">CHALLENGE_ID</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="n">CHALLENGE_ID</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">A</span><span class="p">.</span><span class="n">CONTEST_ID</span><span class="p">,</span> <span class="n">A</span><span class="p">.</span><span class="n">HACKER_ID</span><span class="p">,</span> <span class="n">A</span><span class="p">.</span><span class="n">NAME</span>
<span class="k">HAVING</span> <span class="p">(</span><span class="n">TOTAL_SUBMISSIONS</span> <span class="o">+</span> <span class="n">TOTAL_ACCEPTED_SUBMISSIONS</span> <span class="o">+</span> <span class="n">TOTAL_VIEWS</span> <span class="o">+</span> <span class="n">TOTAL_UNIQUE_VIEWS</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> 
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">A</span><span class="p">.</span><span class="n">CONTEST_ID</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-54-"><span style="color:#4cbb17">(**) Bài 54: </span></h4>

<p><img src="https://i.imgur.com/9omFiXI.png" alt="Imgur" />
<img src="https://i.imgur.com/RPecYXo.png" alt="Imgur" />
<img src="https://i.imgur.com/C5vkKoz.png" alt="Imgur" />
<img src="https://i.imgur.com/REqPwkR.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">SUBMISSION_DATE</span><span class="p">,</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">HACKER_ID</span><span class="p">)</span>  
 <span class="k">FROM</span> <span class="n">SUBMISSIONS</span> <span class="n">S2</span>  
 <span class="k">WHERE</span> <span class="n">S2</span><span class="p">.</span><span class="n">SUBMISSION_DATE</span> <span class="o">=</span> <span class="n">S1</span><span class="p">.</span><span class="n">SUBMISSION_DATE</span> <span class="k">AND</span>    
<span class="p">(</span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">S3</span><span class="p">.</span><span class="n">SUBMISSION_DATE</span><span class="p">)</span> 
 <span class="k">FROM</span> <span class="n">SUBMISSIONS</span> <span class="n">S3</span> <span class="k">WHERE</span> <span class="n">S3</span><span class="p">.</span><span class="n">HACKER_ID</span> <span class="o">=</span> <span class="n">S2</span><span class="p">.</span><span class="n">HACKER_ID</span> <span class="k">AND</span> <span class="n">S3</span><span class="p">.</span><span class="n">SUBMISSION_DATE</span> <span class="o">&lt;</span> <span class="n">S1</span><span class="p">.</span><span class="n">SUBMISSION_DATE</span><span class="p">)</span> <span class="o">=</span> <span class="n">DATEDIFF</span><span class="p">(</span><span class="n">S1</span><span class="p">.</span><span class="n">SUBMISSION_DATE</span> <span class="p">,</span> <span class="s1">'2016-03-01'</span><span class="p">)),</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="n">HACKER_ID</span> <span class="k">FROM</span> <span class="n">SUBMISSIONS</span> <span class="n">S2</span> <span class="k">WHERE</span> <span class="n">S2</span><span class="p">.</span><span class="n">SUBMISSION_DATE</span> <span class="o">=</span> <span class="n">S1</span><span class="p">.</span><span class="n">SUBMISSION_DATE</span> 
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">HACKER_ID</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">SUBMISSION_ID</span><span class="p">)</span> <span class="k">DESC</span><span class="p">,</span> <span class="n">HACKER_ID</span> <span class="k">LIMIT</span> <span class="mi">1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TMP</span><span class="p">,</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="n">NAME</span> <span class="k">FROM</span> <span class="n">HACKERS</span> <span class="k">WHERE</span> <span class="n">HACKER_ID</span> <span class="o">=</span> <span class="n">TMP</span><span class="p">)</span>
<span class="k">FROM</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">SUBMISSION_DATE</span> <span class="k">FROM</span> <span class="n">SUBMISSIONS</span><span class="p">)</span> <span class="n">S1</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">SUBMISSION_DATE</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="-bài-55-"><span style="color:#4cbb17">(**) Bài 55: </span></h4>

<p><img src="https://i.imgur.com/VPFpidr.png" alt="Imgur" /></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">SET</span> <span class="o">@</span><span class="n">number</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="k">SET</span> <span class="o">@</span><span class="n">divisor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="n">GROUP_CONCAT</span><span class="p">(</span><span class="n">n</span> <span class="n">SEPARATOR</span> <span class="s1">'&amp;'</span><span class="p">)</span>
  <span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">@</span><span class="n">number</span> <span class="p">:</span><span class="o">=</span> <span class="o">@</span><span class="n">number</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">AS</span> <span class="n">n</span> 
          <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">AS</span> <span class="n">t1</span><span class="p">,</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">AS</span> <span class="n">t2</span>
         <span class="k">LIMIT</span> <span class="mi">1000</span>
       <span class="p">)</span> <span class="k">AS</span> <span class="n">n1</span>
 <span class="k">WHERE</span> <span class="k">NOT</span> <span class="k">EXISTS</span><span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span>
                    <span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">@</span><span class="n">divisor</span> <span class="p">:</span><span class="o">=</span> <span class="o">@</span><span class="n">divisor</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">AS</span> <span class="n">d</span>
                            <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">AS</span> <span class="n">t3</span><span class="p">,</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">AS</span> <span class="n">t4</span>
                           <span class="k">LIMIT</span> <span class="mi">1000</span>
                         <span class="p">)</span> <span class="k">AS</span> <span class="n">n2</span>
                   <span class="k">WHERE</span> <span class="k">MOD</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">AND</span> <span class="n">n</span> <span class="o">&lt;&gt;</span> <span class="n">d</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h3 id="ngày-01-03-2022">Ngày 01-03-2022</h3>

<h4 id="soạn-bài">Soạn bài</h4>

<ol>
  <li>Tải và cài đặt SQL EXpress 2019: Hướng dẫn cài đặt <a href="https://www.youtube.com/watch?v=c9NQLLboSeg">tại đây</a></li>
</ol>

<h4 id="cách-thức-viết-câu-lệnh">Cách thức viết câu lệnh:</h4>

<ul>
  <li>
    <p>Nguyên tắc người viết code: “Tnh tế trong từng câu lệnh”, luôn luôn phải hiểu “Viết ra đoạn code để cho người khác đọc và hiểu được” do đó:</p>
  </li>
  <li>
    <p>Trình bày trong khuôn khổ màn hình ngang máy tính</p>
  </li>
  <li>
    <p>Sử dụng tab khi lùi dòng vào phía trong</p>
  </li>
  <li>
    <p>Trình bày phải có dấu cách sau dấu “,”</p>
  </li>
  <li>
    <p>Trình bày theo khối lệnh, gọn gàng, cách dòng trong khối lệnh cho dễ quan sát</p>
  </li>
  <li>
    <p>Các từ khoá viết hoa: SELECT … FROM</p>
  </li>
  <li>
    <p>Lưu ý đến Performance của đoạn lệnh:</p>
  </li>
  <li>
    <p>Kiểm tra chỉ mục trên tất cả các field trên mệnh đề WHERE and JOIN trong câu lệnh SQL</p>
  </li>
  <li>
    <p>Giới hạn kích thước của bảng dữ liệu làm việc: Kiểm tra các bảng được sử dụng trong câu SELECT để có thể áp dụng lọc qua WHERE</p>
  </li>
  <li>
    <p>Chỉ chọn các field mà trong báo cáo cần tránh thừa thông tin</p>
  </li>
  <li>
    <p>Loại bỏ các phần tính toán trong mệnh đề WHERE và JOIN</p>
  </li>
  <li>
    <p>Đặt Index với các Field hay được truy vấn</p>
  </li>
  <li>
    <p>Đặt kích thước của các field theo nguyên tắc byte: 2^n</p>
  </li>
  <li>
    <p>Đầu mã thủ tục, hàm phải có thông tin chung:</p>
  </li>
  <li>
    <p>Người tạo</p>
  </li>
  <li>
    <p>Ngày khởi tạo</p>
  </li>
  <li>
    <p>Mô tả chung</p>
  </li>
  <li>
    <p>Mỗi lần đoạn mã được sửa đổi phải được ghi chú (Comment) rõ ràng:</p>
  </li>
  <li>
    <p>Người sửa đổi</p>
  </li>
  <li>
    <p>Ngày sửa đổi</p>
  </li>
  <li>
    <p>Nội dung chỉnh sửa</p>
  </li>
  <li>
    <p>Các đoạn lệnh có thuật toán phức tạp cần có ghi chú rõ ràng</p>
  </li>
  <li>
    <p>Các câu ghi chú cần rõ ràng, ngắn gọn, đủ nghĩa, không dài dòng.</p>
  </li>
</ul>

<h5 id="bai-tap-1">Bai tap 1:</h5>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">Tech</span><span class="p">;</span>
<span class="k">GO</span>

<span class="n">USE</span> <span class="n">Tech</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Item</span><span class="p">(</span>
    <span class="n">ItemCode</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">ItemName</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">96</span><span class="p">),</span>
    <span class="n">Unit</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">ItemType</span> <span class="nb">INT</span><span class="p">,</span>
    <span class="n">IsActive</span> <span class="nb">INT</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">GO</span> 

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Customer</span><span class="p">(</span>

<span class="p">)</span>
</code></pre></div></div>

<h4 id="học-chính-thức">Học chính thức</h4>

<h5 id="tóm-tắt">Tóm tắt:</h5>

<ul>
  <li>
    <p>Bài học đầu tiên: SQL</p>
  </li>
  <li>
    <p>Nếu đạt -&gt; học xml</p>
  </li>
  <li>
    <p>Học về nghiệp vụ</p>
  </li>
  <li>
    <p>Thời gian: 3 tháng</p>
  </li>
  <li>
    <p>xml + nghiệp vụ: Full Time</p>
  </li>
</ul>

<h5 id="chính-thức">Chính thức:</h5>

<ul>
  <li>
    <p>Chú ý: Tiếp cận các bài toán và thuật toán thực tế</p>
  </li>
  <li>
    <p>Đặt tên: Dấu + -&gt; _, nộp bài đúng thời gian được giao</p>
  </li>
  <li>
    <p>Chú ý: Tìm hiểu về các phiên bản của SQL</p>
  </li>
  <li>
    <p>SQL 2019: Nhiều feature mới mà nhiều bản khác không có, ví dụ: merge</p>
  </li>
  <li>
    <p>Những cái khi quy mô lớn: Link Server, Always On (học sau)</p>
  </li>
  <li>
    <p>Nghiên cứu thêm về mảng Security</p>
  </li>
  <li>
    <p>Chú ý: WHERE và JOIN phải có index và không có xử lý tính toán</p>
  </li>
  <li>
    <p>Chú ý: Không SELECT * khi dữ liệu lớn</p>
  </li>
</ul>

<h5 id="bài-1-tạo-bảng">Bài 1: Tạo bảng</h5>

<p>Đề bài: Tạo bảng có 2 trường là: <code class="language-plaintext highlighter-rouge">manhanvien</code> và <code class="language-plaintext highlighter-rouge">tennhanvien</code></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">USE</span> <span class="n">buoi1</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">DEMO1</span><span class="p">(</span>
	<span class="n">manhanvien</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
	<span class="n">tennhanvien</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">)</span>

<span class="cm">/* Bo sung not null*/</span>
<span class="c1">--USE buoi1</span>
<span class="c1">--CREATE TABLE DEMO2(</span>
<span class="c1">--	manhanvien NVARCHAR(16) NOT NULL DEFAULT(''),</span>
<span class="c1">--	tennhanvien NVARCHAR(50) NOT NULL DEFAULT('')</span>
<span class="c1">--)</span>

<span class="cm">/**/</span>
</code></pre></div></div>

<h5 id="bài-2-sử-dụng-câu-lệnh-alter-để-thêm-một-cột-socmnd">Bài 2: Sử dụng câu lệnh ALTER để thêm một cột <code class="language-plaintext highlighter-rouge">socmnd</code></h5>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">DEMO1</span> <span class="k">ADD</span> <span class="n">socmnd</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</code></pre></div></div>
<p>Note: Để xem lại cột ta đã thêm được chưa vào thư mục nhất nút phải để kiểm tra.</p>

<h5 id="bài-3-drop-bảng">Bài 3: DROP bảng</h5>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">DEMO1</span>
</code></pre></div></div>

<h5 id="bài-4-sao-chép-cấu-trúc-để-tạo-bảng-mới">Bài 4: Sao chép cấu trúc để tạo bảng mới</h5>

<p><code class="language-plaintext highlighter-rouge">dbo.DEMO1</code> -&gt; <code class="language-plaintext highlighter-rouge">Script Table as</code> -&gt; <code class="language-plaintext highlighter-rouge">CREATE To</code> -&gt; <code class="language-plaintext highlighter-rouge">New query Editor Window</code> (Nhấn nút phải)</p>

<h5 id="bài-5-insert-dữ-liệu-chú-ý-bổ-sung-cú-pháp">Bài 5: INSERT dữ liệu (chú ý bổ sung cú pháp)</h5>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">DEMO1</span> <span class="p">(</span><span class="n">manhanvien</span><span class="p">,</span> <span class="n">tennhanvien</span><span class="p">,</span> <span class="n">socmnd</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'ID1001'</span><span class="p">,</span><span class="s1">'Ngo Tan Tri'</span><span class="p">,</span> <span class="s1">'201793988'</span><span class="p">)</span>
</code></pre></div></div>

<p>Note: Chú ý để xem bảng kết quả ta vào: <code class="language-plaintext highlighter-rouge">dbo.DEMO1</code> -&gt; <code class="language-plaintext highlighter-rouge">Edit Top 200 rows</code></p>

<p>Nâng cao: Insert 1 lần 2 thanh ghi:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">DEMO1</span> <span class="p">(</span><span class="n">manhanvien</span><span class="p">,</span> <span class="n">tennhanvien</span><span class="p">,</span> <span class="n">socmnd</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'ID1001'</span><span class="p">,</span><span class="s1">'Ngo Tan B'</span><span class="p">,</span> <span class="s1">'201793918'</span><span class="p">),(</span><span class="s1">'ID1002'</span><span class="p">,</span><span class="s1">'Ngo Tan C'</span><span class="p">,</span> <span class="s1">'201793999'</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">DEMO1</span>
</code></pre></div></div>

<p>Note: Chú ý bôi đen rồi f5 để chạy</p>

<h6 id="bài-6-update-dữ-liệu-biến-đổi-số-chứng-minh-nhân-dân-thành-số-điện-thoại">Bài 6: UPDATE dữ liệu biến đổi số chứng minh nhân dân thành số điện thoại</h6>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">DEMO1</span> <span class="k">SET</span> <span class="n">socmnd</span> <span class="o">=</span> <span class="s1">'0787135926'</span>  <span class="k">WHERE</span> <span class="n">tennhanvien</span> <span class="o">=</span> <span class="s1">'Ngo Tan Tri'</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">DEMO1</span>
</code></pre></div></div>

<p>Cách 2: Chú ý khi viết xuống dòng (tinh tế)</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">DEMO1</span> 
	<span class="k">SET</span> <span class="n">socmnd</span> <span class="o">=</span> <span class="s1">'0787135926'</span>  
	<span class="k">WHERE</span> <span class="n">tennhanvien</span> <span class="o">=</span> <span class="s1">'Ngo Tan Tri'</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">DEMO1</span>
</code></pre></div></div>

<h6 id="bài-7-xoá-những-thanh-ghi-không-phải-là-tên-mình">Bài 7: Xoá những thanh ghi không phải là tên mình</h6>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">DEMO1</span> <span class="k">WHERE</span> <span class="n">tennhanvien</span><span class="o">!=</span><span class="s1">'Ngo Tan Tri'</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">DEMO1</span>
</code></pre></div></div>

<p>Note: Dấu <code class="language-plaintext highlighter-rouge">!=</code> có thể thay thế bằng <code class="language-plaintext highlighter-rouge">&lt;&gt;</code></p>

<h6 id="bài-8-các-chú-ý-trong-hàm-toán-học">Bài 8: Các chú ý trong hàm toán học</h6>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PRINT</span> <span class="k">ABS</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="n">FLOOR</span><span class="p">(</span><span class="mi">9</span><span class="p">.</span><span class="mi">9</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="n">ROUND</span><span class="p">(</span><span class="mi">1000</span><span class="p">.</span><span class="mi">999</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="n">ROUND</span><span class="p">(</span><span class="mi">11</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>
<h6 id="bài-9-xử-lý-hàm-chuỗi">Bài 9: Xử lý hàm chuỗi</h6>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PRINT</span> <span class="k">LEFT</span><span class="p">(</span><span class="s1">'Lê Anh Tuấn'</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="s1">'abcdee'</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">PRINT</span> <span class="k">REPLACE</span><span class="p">(</span><span class="s1">'ABCDEF'</span><span class="p">,</span><span class="s1">'CDEF'</span><span class="p">,</span><span class="s1">'aaaaaa'</span><span class="p">)</span>
</code></pre></div></div>

<p>Chú ý: Để sử dụng tiếng Việt thêm chữ N phía trước: <code class="language-plaintext highlighter-rouge">PRINT REPLACE(N'Lê Anh Tuấn',' ','')</code></p>

<h6 id="bài-tập-về-nhà-tự-làm">Bài tập về nhà (Tự làm)</h6>

<p><code class="language-plaintext highlighter-rouge">Bài 1</code>: Lập bảng và insert dữ liệu:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">USE</span> <span class="n">Tech</span>

<span class="cm">/* Create table Item*/</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Item</span> <span class="p">(</span>
	<span class="n">ItemCode</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
	<span class="n">ItemName</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">96</span><span class="p">),</span>
	<span class="n">Unit</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="n">ItemType</span> <span class="nb">INT</span><span class="p">,</span>
	<span class="n">IsActive</span> <span class="nb">INT</span>
<span class="p">)</span>
<span class="cm">/* Create table Customer*/</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Customer</span><span class="p">(</span>
	<span class="n">CustomerCode</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
	<span class="n">CustomerName</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">96</span><span class="p">),</span>
	<span class="n">CustomerType</span> <span class="nb">INT</span><span class="p">,</span>
	<span class="n">IsActive</span> <span class="nb">INT</span>
<span class="p">)</span>

<span class="cm">/* Create table AccDoc*/</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">AccDoc</span><span class="p">(</span>
	<span class="n">DocCode</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
	<span class="n">DocNo</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
	<span class="n">DocDate</span> <span class="nb">DATETIME</span><span class="p">,</span>
	<span class="n">CustomerCode</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
	<span class="n">DocGroup</span> <span class="nb">INT</span><span class="p">,</span>
	<span class="n">Description</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">),</span>
	<span class="n">IsActive</span> <span class="nb">INT</span>
<span class="p">)</span>

<span class="cm">/* Create table AccDocDetail*/</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">AccDocDetail</span><span class="p">(</span>
	<span class="n">DocCode</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="cm">/*Link DocCode cua AccDoc*/</span>
	<span class="n">DocNo</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="cm">/*Link DocNo cua AccDoc*/</span>
	<span class="n">ItemCode</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
	<span class="n">Quantity</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
	<span class="n">UnitCost</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
	<span class="n">Amount1</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
	<span class="n">UnitPrice</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
	<span class="n">Amount2</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>

<span class="cm">/* Create table AccDocDetail*/</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">OpenInventory</span><span class="p">(</span>
	<span class="n">ItemCode</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
	<span class="n">Quantity</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
	<span class="n">Amount</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>

<span class="cm">/* insert data into table Item*/</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Item</span><span class="p">(</span><span class="n">ItemCode</span><span class="p">,</span><span class="n">ItemName</span><span class="p">,</span><span class="n">Unit</span><span class="p">,</span><span class="n">ItemType</span><span class="p">,</span><span class="n">IsActive</span><span class="p">)</span> 
	<span class="k">VALUES</span> 
		<span class="p">(</span><span class="s1">'NVLC01'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Máy nén'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Cái'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NVLC02'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Tôn dày 0.5 mm'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Kg'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NVLC03'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Ống đồng'</span><span class="p">,</span> <span class="s1">'M'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP01'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Tủ đông kích thước 1.5*0.7*0.6'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Cái'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP02'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Tủ đông kích thước 1.5*0.8*0.8'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Cái'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP03'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Tủ mát kích thước 0.8*0.8*1.9'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Cái'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">--SELECT * FROM Item </span>

<span class="cm">/* insert data into table Customer*/</span>
	
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Customer</span><span class="p">(</span><span class="n">CustomerCode</span><span class="p">,</span><span class="n">CustomerName</span><span class="p">,</span><span class="n">CustomerType</span><span class="p">,</span><span class="n">IsActive</span><span class="p">)</span>
	<span class="k">VALUES</span>
		<span class="p">(</span><span class="s1">'NCC01'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Công ty TNHH Vạn Xuân'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NCC02'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Công ty Cổ phần Đại Phát'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NCC03'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Công ty Cổ phần tôn Hòa Phát'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'KH01'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Đại lý Cô Tám'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'KH02'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Công ty cổ phần đầu tư xây dựng Dacinco'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'KH03'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Công ty TNHH cà phê Thắng Lợi'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NB01'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Phi Công Anh'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NB02'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Đàm Văn Đức'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NB03'</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Phân xưởng sản xuất'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="k">NULL</span><span class="p">)</span>

<span class="c1">--SELECT * FROM Customer</span>

<span class="cm">/*insert data into table AccDoc*/</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">AccDoc</span><span class="p">(</span><span class="n">DocCode</span><span class="p">,</span> <span class="n">DocNo</span><span class="p">,</span> <span class="n">DocDate</span><span class="p">,</span> <span class="n">CustomerCode</span><span class="p">,</span> <span class="n">DocGroup</span><span class="p">,</span> <span class="n">Description</span><span class="p">,</span> <span class="n">IsActive</span><span class="p">)</span>
	<span class="k">VALUES</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM001'</span><span class="p">,</span> <span class="s1">'01/01/2022'</span><span class="p">,</span> <span class="s1">'NCC01'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Nhập mua NPL'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM002'</span><span class="p">,</span> <span class="s1">'01/10/2022'</span><span class="p">,</span> <span class="s1">'NCC02'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Nhập mua NPL'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM003'</span><span class="p">,</span> <span class="s1">'01/11/2022'</span><span class="p">,</span> <span class="s1">'NCC01'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Nhập mua NPL'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM004'</span><span class="p">,</span> <span class="s1">'01/15/2022'</span><span class="p">,</span> <span class="s1">'NCC03'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Nhập mua NPL'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX001'</span><span class="p">,</span> <span class="s1">'01/02/2022'</span><span class="p">,</span> <span class="s1">'NB03'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất sản xuất'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX002'</span><span class="p">,</span> <span class="s1">'01/13/2022'</span><span class="p">,</span> <span class="s1">'NB03'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất sản xuất'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX003'</span><span class="p">,</span> <span class="s1">'01/22/2022'</span><span class="p">,</span> <span class="s1">'NB03'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất sản xuất'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX004'</span><span class="p">,</span> <span class="s1">'01/28/2022'</span><span class="p">,</span> <span class="s1">'NB03'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất sản xuất'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP'</span><span class="p">,</span> <span class="s1">'TP001'</span><span class="p">,</span> <span class="s1">'01/15/2022'</span><span class="p">,</span> <span class="s1">'NB03'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Nhập thành phẩm'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP'</span><span class="p">,</span> <span class="s1">'TP002'</span><span class="p">,</span> <span class="s1">'01/31/2022'</span><span class="p">,</span> <span class="s1">'NB03'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Nhập thành phẩm'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD001'</span><span class="p">,</span> <span class="s1">'01/05/2022'</span><span class="p">,</span> <span class="s1">'KH01'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất bán hàng'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD002'</span><span class="p">,</span> <span class="s1">'01/06/2022'</span><span class="p">,</span> <span class="s1">'KH03'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất bán hàng'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD003'</span><span class="p">,</span> <span class="s1">'01/10/2022'</span><span class="p">,</span> <span class="s1">'KH02'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất bán hàng'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD004'</span><span class="p">,</span> <span class="s1">'01/12/2022'</span><span class="p">,</span> <span class="s1">'KH01'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất bán hàng'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD005'</span><span class="p">,</span> <span class="s1">'01/16/2022'</span><span class="p">,</span> <span class="s1">'KH02'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất bán hàng'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD006'</span><span class="p">,</span> <span class="s1">'01/18/2022'</span><span class="p">,</span> <span class="s1">'KH03'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất bán hàng'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD007'</span><span class="p">,</span> <span class="s1">'01/23/2022'</span><span class="p">,</span> <span class="s1">'KH01'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất bán hàng'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD008'</span><span class="p">,</span> <span class="s1">'01/31/2022'</span><span class="p">,</span> <span class="s1">'KH03'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="s1">'Xuất bán hàng'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
	
<span class="c1">--SELECT * FROM AccDoc	</span>

<span class="cm">/* insert data into table AccDocDetail*/</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">AccDocDetail</span><span class="p">(</span><span class="n">DocCode</span><span class="p">,</span> <span class="n">DocNo</span><span class="p">,</span> <span class="n">ItemCode</span><span class="p">,</span> <span class="n">Quantity</span><span class="p">,</span> <span class="n">UnitCost</span><span class="p">,</span> <span class="n">Amount1</span><span class="p">,</span> <span class="n">UnitPrice</span><span class="p">,</span> <span class="n">Amount2</span><span class="p">)</span>
	<span class="k">VALUES</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM001'</span><span class="p">,</span> <span class="s1">'NVLC01'</span><span class="p">,</span> <span class="mi">100</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">3099000</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">309900000</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span> <span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM001'</span><span class="p">,</span> <span class="s1">'NVLC02'</span><span class="p">,</span> <span class="mi">999</span><span class="p">.</span><span class="mi">95</span><span class="p">,</span> <span class="mi">29956</span><span class="p">.</span><span class="mi">35</span><span class="p">,</span> <span class="mi">29954852</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM002'</span><span class="p">,</span> <span class="s1">'NVLC01'</span><span class="p">,</span> <span class="mi">50</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">3050000</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">152500000</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM002'</span><span class="p">,</span> <span class="s1">'NVLC02'</span><span class="p">,</span> <span class="mi">200</span><span class="p">.</span><span class="mi">33</span><span class="p">,</span> <span class="mi">29956</span><span class="p">.</span><span class="mi">55</span><span class="p">,</span> <span class="mi">6001196</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM002'</span><span class="p">,</span> <span class="s1">'NVLC03'</span><span class="p">,</span> <span class="mi">2000</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">105987</span><span class="p">.</span><span class="mi">92</span><span class="p">,</span> <span class="mi">211975840</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM003'</span><span class="p">,</span> <span class="s1">'NVLC01'</span><span class="p">,</span> <span class="mi">60</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">3050000</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">183000000</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM003'</span><span class="p">,</span> <span class="s1">'NVLC02'</span><span class="p">,</span> <span class="mi">100</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">29956</span><span class="p">.</span><span class="mi">55</span><span class="p">,</span> <span class="mi">2995655</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM003'</span><span class="p">,</span> <span class="s1">'NVLC03'</span><span class="p">,</span> <span class="mi">150</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">105987</span><span class="p">.</span><span class="mi">92</span><span class="p">,</span> <span class="mi">15898188</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM004'</span><span class="p">,</span> <span class="s1">'NVLC01'</span><span class="p">,</span> <span class="mi">90</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">3050000</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">274500000</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM004'</span><span class="p">,</span> <span class="s1">'NVLC02'</span><span class="p">,</span> <span class="mi">300</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">29956</span><span class="p">.</span><span class="mi">55</span><span class="p">,</span> <span class="mi">8986965</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NM'</span><span class="p">,</span> <span class="s1">'NM004'</span><span class="p">,</span> <span class="s1">'NVLC03'</span><span class="p">,</span> <span class="mi">200</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="mi">105987</span><span class="p">.</span><span class="mi">92</span><span class="p">,</span> <span class="mi">21197584</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX001'</span><span class="p">,</span> <span class="s1">'NVLC01'</span><span class="p">,</span> <span class="mi">90</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX001'</span><span class="p">,</span> <span class="s1">'NVLC02'</span><span class="p">,</span> <span class="mi">500</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span><span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX001'</span><span class="p">,</span> <span class="s1">'NVLC03'</span><span class="p">,</span> <span class="mi">400</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX002'</span><span class="p">,</span> <span class="s1">'NVLC01'</span><span class="p">,</span> <span class="mi">50</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX002'</span><span class="p">,</span> <span class="s1">'NVLC02'</span><span class="p">,</span> <span class="mi">200</span><span class="p">.</span><span class="mi">33</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX002'</span><span class="p">,</span> <span class="s1">'NVLC03'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX003'</span><span class="p">,</span> <span class="s1">'NVLC01'</span><span class="p">,</span> <span class="mi">100</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX003'</span><span class="p">,</span> <span class="s1">'NVLC02'</span><span class="p">,</span> <span class="mi">150</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX003'</span><span class="p">,</span> <span class="s1">'NVLC03'</span><span class="p">,</span> <span class="mi">200</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX004'</span><span class="p">,</span> <span class="s1">'NVLC01'</span><span class="p">,</span> <span class="mi">90</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX004'</span><span class="p">,</span> <span class="s1">'NVLC02'</span><span class="p">,</span> <span class="mi">320</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'PX'</span><span class="p">,</span> <span class="s1">'PX004'</span><span class="p">,</span> <span class="s1">'NVLC03'</span><span class="p">,</span> <span class="mi">170</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP'</span><span class="p">,</span> <span class="s1">'TP001'</span><span class="p">,</span> <span class="s1">'TP01'</span><span class="p">,</span> <span class="mi">400</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP'</span><span class="p">,</span> <span class="s1">'TP001'</span><span class="p">,</span> <span class="s1">'TP02'</span><span class="p">,</span> <span class="mi">500</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP'</span><span class="p">,</span> <span class="s1">'TP001'</span><span class="p">,</span> <span class="s1">'TP03'</span><span class="p">,</span> <span class="mi">700</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP'</span><span class="p">,</span> <span class="s1">'TP002'</span><span class="p">,</span> <span class="s1">'TP01'</span><span class="p">,</span> <span class="mi">300</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP'</span><span class="p">,</span> <span class="s1">'TP002'</span><span class="p">,</span> <span class="s1">'TP02'</span><span class="p">,</span> <span class="mi">200</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP'</span><span class="p">,</span> <span class="s1">'TP002'</span><span class="p">,</span> <span class="s1">'TP03'</span><span class="p">,</span> <span class="mi">200</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD001'</span><span class="p">,</span> <span class="s1">'TP02'</span><span class="p">,</span> <span class="mi">100</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">11000000</span><span class="p">,</span> <span class="mi">1100000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD001'</span><span class="p">,</span> <span class="s1">'TP03'</span><span class="p">,</span> <span class="mi">300</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">12000000</span><span class="p">,</span> <span class="mi">3600000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD002'</span><span class="p">,</span> <span class="s1">'TP01'</span><span class="p">,</span> <span class="mi">50</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">,</span> <span class="mi">500000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD002'</span><span class="p">,</span> <span class="s1">'TP03'</span><span class="p">,</span> <span class="mi">150</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">12000000</span><span class="p">,</span><span class="mi">1800000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD003'</span><span class="p">,</span> <span class="s1">'TP01'</span><span class="p">,</span> <span class="mi">50</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">,</span> <span class="mi">500000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD003'</span><span class="p">,</span> <span class="s1">'TP02'</span><span class="p">,</span> <span class="mi">100</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">11000000</span><span class="p">,</span> <span class="mi">1100000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD004'</span><span class="p">,</span> <span class="s1">'TP01'</span><span class="p">,</span> <span class="mi">90</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">,</span> <span class="mi">900000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD004'</span><span class="p">,</span> <span class="s1">'TP02'</span><span class="p">,</span> <span class="mi">270</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">11000000</span><span class="p">,</span> <span class="mi">2970000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD004'</span><span class="p">,</span> <span class="s1">'TP03'</span><span class="p">,</span> <span class="mi">140</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">12000000</span><span class="p">,</span> <span class="mi">1680000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD005'</span><span class="p">,</span> <span class="s1">'TP02'</span><span class="p">,</span> <span class="mi">100</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">11000000</span><span class="p">,</span> <span class="mi">1100000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD005'</span><span class="p">,</span> <span class="s1">'TP03'</span><span class="p">,</span> <span class="mi">300</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">12000000</span><span class="p">,</span> <span class="mi">3600000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD006'</span><span class="p">,</span> <span class="s1">'TP01'</span><span class="p">,</span> <span class="mi">50</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">,</span> <span class="mi">500000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD006'</span><span class="p">,</span> <span class="s1">'TP03'</span><span class="p">,</span> <span class="mi">150</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">12000000</span><span class="p">,</span> <span class="mi">1800000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD007'</span><span class="p">,</span> <span class="s1">'TP01'</span><span class="p">,</span> <span class="mi">50</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">,</span> <span class="mi">500000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD008'</span><span class="p">,</span> <span class="s1">'TP02'</span><span class="p">,</span> <span class="mi">100</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">11000000</span><span class="p">,</span> <span class="mi">1100000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD008'</span><span class="p">,</span> <span class="s1">'TP01'</span><span class="p">,</span> <span class="mi">90</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">,</span> <span class="mi">900000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD008'</span><span class="p">,</span> <span class="s1">'TP02'</span><span class="p">,</span> <span class="mi">270</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span><span class="k">NULL</span><span class="p">,</span> <span class="mi">11000000</span><span class="p">,</span> <span class="mi">2970000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'HD'</span><span class="p">,</span> <span class="s1">'HD008'</span><span class="p">,</span> <span class="s1">'TP03'</span><span class="p">,</span> <span class="mi">140</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">12000000</span><span class="p">,</span> <span class="mi">1680000000</span><span class="p">)</span>

<span class="c1">--SELECT * FROM AccDocDetail</span>

<span class="cm">/* insert data into table OpenInventpry*/</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">OpenInventory</span><span class="p">(</span><span class="n">ItemCode</span><span class="p">,</span> <span class="n">Quantity</span><span class="p">,</span> <span class="n">Amount</span><span class="p">)</span>
	<span class="k">VALUES</span> 
		<span class="p">(</span><span class="s1">'NVLC01'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3000000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NVLC02'</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">46500000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'NVLC03'</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">210000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP01'</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">2000000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP02'</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">2000000000</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'TP03'</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">2520000000</span><span class="p">)</span>

<span class="c1">--SELECT * FROM OpenInventory</span>

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Bài 2</code>: Bài tập về hàm</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/* Bai tap ve ham*/</span>
<span class="n">USE</span> <span class="n">Tech</span>

<span class="cm">/* Bai 1: Hien thi thong tin: Bang chi tiet chung tu voi nhung vat tu co Quantity khong phai la so nguyen*/</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">AccDocDetail</span> <span class="k">WHERE</span> <span class="n">FLOOR</span><span class="p">(</span><span class="n">Quantity</span><span class="p">)</span> <span class="o">!=</span> <span class="n">CEILING</span><span class="p">(</span><span class="n">Quantity</span><span class="p">)</span>

<span class="cm">/*Bai 2: Cho mot chuoi ho va ten: Lay ra ten dem va ten*/</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_ho_va_ten</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_empty_first_pos</span> <span class="nb">INT</span><span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_empty_second_pos</span> <span class="nb">INT</span><span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_length</span> <span class="nb">INT</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ho_va_ten</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'     Ngo Tan Tri   '</span> <span class="p">;</span> 

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ho_va_ten</span> <span class="o">=</span>  <span class="n">LTRIM</span><span class="p">(</span><span class="o">@</span><span class="n">_ho_va_ten</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ho_va_ten</span> <span class="o">=</span>  <span class="n">RTRIM</span><span class="p">(</span><span class="o">@</span><span class="n">_ho_va_ten</span><span class="p">)</span>

<span class="n">PRINT</span><span class="p">(</span><span class="s1">'Toi len la:  '</span> <span class="o">+</span> <span class="o">@</span><span class="n">_ho_va_ten</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_length</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="o">@</span><span class="n">_ho_va_ten</span><span class="p">)</span> <span class="p">;</span> 

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_empty_first_pos</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="o">@</span><span class="n">_ho_va_ten</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> 

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_empty_second_pos</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="o">@</span><span class="n">_ho_va_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_empty_first_pos</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> 

<span class="n">PRINT</span><span class="p">(</span><span class="s1">'Ten dem la: '</span> <span class="o">+</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_ho_va_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_empty_first_pos</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_empty_second_pos</span><span class="o">-</span><span class="p">(</span><span class="o">@</span><span class="n">_empty_first_pos</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">PRINT</span><span class="p">(</span><span class="s1">'Ten la: '</span> <span class="o">+</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_ho_va_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_empty_second_pos</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_length</span><span class="o">-@</span><span class="n">_empty_second_pos</span><span class="p">))</span>
<span class="c1">--PRINT(@_empty_second_pos)</span>

<span class="cm">/*Bai 3: Cho chuoi @_A, cat ky tu chuoi @_A de hien thi du lieu theo tung dong*/</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_A</span> <span class="n">NVARCHAR</span> <span class="p">(</span><span class="mi">32</span><span class="p">);</span> 

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_leng</span> <span class="nb">INT</span><span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_pos_</span> <span class="nb">INT</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_A</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'Bố, Mẹ, Anh, Chị'</span> 

<span class="cm">/*In Bo*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_leng</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="o">@</span><span class="n">_A</span><span class="p">)</span>

<span class="c1">--PRINT(@_leng)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span><span class="o">@</span><span class="n">_A</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">PRINT</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_A</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_A</span> <span class="o">=</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_A</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">@</span><span class="n">_leng</span> <span class="o">-</span> <span class="p">(</span><span class="o">@</span><span class="n">_pos_</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="c1">--PRINT(@_A)</span>

<span class="cm">/*In Me */</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_leng</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="o">@</span><span class="n">_A</span><span class="p">)</span>

<span class="c1">--PRINT(@_leng)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span><span class="o">@</span><span class="n">_A</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">PRINT</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_A</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_A</span> <span class="o">=</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_A</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">@</span><span class="n">_leng</span> <span class="o">-</span> <span class="p">(</span><span class="o">@</span><span class="n">_pos_</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="c1">--PRINT(@_A)</span>

<span class="cm">/*In Anh*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_leng</span> <span class="o">=</span> <span class="n">LEN</span><span class="p">(</span><span class="o">@</span><span class="n">_A</span><span class="p">)</span>

<span class="c1">--PRINT(@_leng)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span><span class="o">@</span><span class="n">_A</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">PRINT</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_A</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_A</span> <span class="o">=</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_A</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">@</span><span class="n">_leng</span> <span class="o">-</span> <span class="p">(</span><span class="o">@</span><span class="n">_pos_</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="cm">/*In Chi*/</span>

<span class="n">PRINT</span><span class="p">(</span><span class="o">@</span><span class="n">_A</span><span class="p">)</span>

<span class="cm">/*Bai 4: Hien thi danh muc vat tu ma co ten vat tu trong chuoi danh sach @_List_Ten_VT = 'May, Dong, Ton'*/</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_List_Ten_VT</span>  <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_List_Ten_VT</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'Máy,Đồng,Tôn'</span> <span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_bien1</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">36</span><span class="p">);</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_bien2</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">36</span><span class="p">);</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_bien3</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">36</span><span class="p">);</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_vtd</span> <span class="nb">INT</span><span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_vtc</span> <span class="nb">INT</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_List_Ten_VT</span> <span class="o">=</span> <span class="o">@</span><span class="n">_List_Ten_VT</span> <span class="o">+</span> <span class="s1">','</span><span class="p">;</span>

<span class="cm">/* Tach lan 1*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_vtd</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_vtc</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span><span class="o">@</span><span class="n">_List_Ten_VT</span><span class="p">,</span><span class="o">@</span><span class="n">_vtd</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_vtd</span> <span class="o">=</span> <span class="o">@</span><span class="n">_vtd</span> <span class="o">+</span><span class="mi">1</span>  <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_bien1</span> <span class="o">=</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_List_Ten_VT</span><span class="p">,</span><span class="o">@</span><span class="n">_vtd</span><span class="p">,</span><span class="o">@</span><span class="n">_vtc</span><span class="o">-@</span><span class="n">_vtd</span><span class="p">)</span>

<span class="n">PRINT</span><span class="p">(</span><span class="o">@</span><span class="n">_bien1</span><span class="p">)</span>

<span class="cm">/* Tach lan 2*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_vtd</span> <span class="o">=</span> <span class="o">@</span><span class="n">_vtc</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_vtc</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span><span class="o">@</span><span class="n">_List_Ten_VT</span><span class="p">,</span><span class="o">@</span><span class="n">_vtd</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_vtd</span> <span class="o">=</span> <span class="o">@</span><span class="n">_vtd</span> <span class="o">+</span><span class="mi">1</span> 

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_bien2</span> <span class="o">=</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_List_Ten_VT</span><span class="p">,</span><span class="o">@</span><span class="n">_vtd</span><span class="p">,</span><span class="o">@</span><span class="n">_vtc</span><span class="o">-@</span><span class="n">_vtd</span><span class="p">)</span>

<span class="n">PRINT</span><span class="p">(</span><span class="o">@</span><span class="n">_bien2</span><span class="p">)</span>

<span class="cm">/* Tach lan 3*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_vtd</span> <span class="o">=</span> <span class="o">@</span><span class="n">_vtc</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_vtc</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span><span class="o">@</span><span class="n">_List_Ten_VT</span><span class="p">,</span><span class="o">@</span><span class="n">_vtd</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_vtd</span> <span class="o">=</span> <span class="o">@</span><span class="n">_vtd</span> <span class="o">+</span><span class="mi">1</span> 

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_bien3</span> <span class="o">=</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_List_Ten_VT</span><span class="p">,</span><span class="o">@</span><span class="n">_vtd</span><span class="p">,</span><span class="o">@</span><span class="n">_vtc</span><span class="o">-@</span><span class="n">_vtd</span><span class="p">)</span>

<span class="n">PRINT</span><span class="p">(</span><span class="o">@</span><span class="n">_bien3</span><span class="p">)</span>

<span class="c1">--PRINT(CHARINDEX('Đồng', @_List_Ten_VT,1))</span>

<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Item</span> <span class="k">WHERE</span> <span class="p">(</span><span class="n">CHARINDEX</span><span class="p">(</span><span class="o">@</span><span class="n">_bien1</span><span class="p">,</span><span class="n">ItemName</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span> <span class="k">OR</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="o">@</span><span class="n">_bien2</span><span class="p">,</span><span class="n">ItemName</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span> <span class="k">OR</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="o">@</span><span class="n">_bien3</span><span class="p">,</span><span class="n">ItemName</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>

<span class="cm">/*Bai 5: Hien thi ky tu dau tien viet hoa va ky tu khac viet thuong trong chuoi ten co 3 tu 'ninH ngỌc hiếU'*/</span>


<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_ten</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_first</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_second</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_pos_start</span> <span class="nb">INT</span><span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_pos_end</span> <span class="nb">INT</span><span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_res</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">36</span><span class="p">);</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ten</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'ninH ngỌc hiếU'</span> 

<span class="cm">/* Start lap*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_res</span> <span class="o">=</span> <span class="s1">''</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ten</span> <span class="o">=</span>  <span class="o">@</span><span class="n">_ten</span> <span class="o">+</span> <span class="s1">' '</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_end</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="o">@</span><span class="n">_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pos_start</span> <span class="o">+</span><span class="mi">1</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_res</span> <span class="o">=</span> <span class="o">@</span><span class="n">_res</span> <span class="o">+</span> <span class="k">UPPER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_start</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">LOWER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_end</span><span class="o">-@</span><span class="n">_pos_start</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pos_end</span> 

<span class="c1">--PRINT(@_res)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_res</span> <span class="o">=</span> <span class="o">@</span><span class="n">_res</span><span class="o">+</span><span class="s1">' '</span> <span class="p">;</span> 

<span class="cm">/*Lap lan 2*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_end</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="o">@</span><span class="n">_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pos_start</span> <span class="o">+</span><span class="mi">1</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_res</span> <span class="o">=</span> <span class="o">@</span><span class="n">_res</span> <span class="o">+</span> <span class="k">UPPER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_start</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">LOWER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_end</span><span class="o">-@</span><span class="n">_pos_start</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pos_end</span> 

<span class="c1">--PRINT(@_res)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_res</span> <span class="o">=</span> <span class="o">@</span><span class="n">_res</span><span class="o">+</span><span class="s1">' '</span> <span class="p">;</span>

<span class="cm">/*Lap lan 3*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_end</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="o">@</span><span class="n">_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pos_start</span> <span class="o">+</span><span class="mi">1</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_res</span> <span class="o">=</span> <span class="o">@</span><span class="n">_res</span> <span class="o">+</span> <span class="k">UPPER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_start</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">LOWER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_ten</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_pos_end</span><span class="o">-@</span><span class="n">_pos_start</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pos_end</span> 

<span class="n">PRINT</span><span class="p">(</span><span class="o">@</span><span class="n">_res</span><span class="p">)</span>

<span class="cm">/* Bai 6: Hien thi ky tu dau tien viet hoa va ky tu khac viet thuong trong chuoi ten 'Hai hoa vinH le nguyen quang'*/</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_pten</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_pfirst</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_psecond</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="nb">INT</span><span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_ppos_end</span> <span class="nb">INT</span><span class="p">;</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_pres</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">36</span><span class="p">);</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pten</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'Hải hòa vinH lê nguyên quang'</span> 

<span class="cm">/* Start lap*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="s1">''</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pten</span> <span class="o">=</span>  <span class="o">@</span><span class="n">_pten</span> <span class="o">+</span> <span class="s1">' '</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_end</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">+</span><span class="mi">1</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">+</span> <span class="k">UPPER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">LOWER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_end</span><span class="o">-@</span><span class="n">_ppos_start</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_end</span> 

<span class="c1">--PRINT(@_res)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pres</span><span class="o">+</span><span class="s1">' '</span> <span class="p">;</span> 

<span class="cm">/*Lap lan 2*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_end</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">+</span><span class="mi">1</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">+</span> <span class="k">UPPER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">LOWER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_end</span><span class="o">-@</span><span class="n">_ppos_start</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_end</span> 

<span class="c1">--PRINT(@_res)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pres</span><span class="o">+</span><span class="s1">' '</span> <span class="p">;</span>

<span class="cm">/*Lap lan 3*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_end</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">+</span><span class="mi">1</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">+</span> <span class="k">UPPER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">LOWER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_end</span><span class="o">-@</span><span class="n">_ppos_start</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_end</span> 

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pres</span><span class="o">+</span><span class="s1">' '</span> <span class="p">;</span>

<span class="c1">--PRINT(@_pres)</span>

<span class="cm">/*Lap lan 4*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_end</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">+</span><span class="mi">1</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">+</span> <span class="k">UPPER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">LOWER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_end</span><span class="o">-@</span><span class="n">_ppos_start</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_end</span> 

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pres</span><span class="o">+</span><span class="s1">' '</span> <span class="p">;</span>

<span class="c1">--PRINT(@_pres)</span>

<span class="cm">/*Lap lan 5*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_end</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">+</span><span class="mi">1</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">+</span> <span class="k">UPPER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">LOWER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_end</span><span class="o">-@</span><span class="n">_ppos_start</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_end</span> 

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pres</span><span class="o">+</span><span class="s1">' '</span> <span class="p">;</span>

<span class="c1">--PRINT(@_pres)</span>

<span class="cm">/*Lap lan 6*/</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_end</span> <span class="o">=</span> <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">+</span><span class="mi">1</span> <span class="p">;</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">=</span> <span class="o">@</span><span class="n">_pres</span> <span class="o">+</span> <span class="k">UPPER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">LOWER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">_pten</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">@</span><span class="n">_ppos_end</span><span class="o">-@</span><span class="n">_ppos_start</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_ppos_start</span> <span class="o">=</span> <span class="o">@</span><span class="n">_ppos_end</span> 

<span class="c1">--SELECT @_pres = @_pres+' ' ;</span>

<span class="n">PRINT</span><span class="p">(</span><span class="o">@</span><span class="n">_pres</span><span class="p">)</span>

<span class="cm">/*TEST*/</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">_d</span> <span class="nb">NUMERIC</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> 

<span class="k">SELECT</span> <span class="o">@</span><span class="n">_d</span> <span class="o">=</span> <span class="mi">999</span><span class="p">.</span><span class="mi">001</span> <span class="p">;</span>

<span class="n">PRINT</span><span class="p">(</span><span class="n">FLOOR</span><span class="p">(</span><span class="o">@</span><span class="n">_d</span><span class="p">))</span>

<span class="n">PRINT</span><span class="p">(</span><span class="n">CEILING</span><span class="p">(</span><span class="o">@</span><span class="n">_d</span><span class="p">))</span>

<span class="n">PRINT</span><span class="p">(</span><span class="o">@</span><span class="n">_d</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span>

</code></pre></div></div>

<h5 id="bài-tập-về-nhà-làm-print">BÀI TẬP VỀ NHÀ: LÀM PRINT</h5>

<h4 id="thứ-6-học-lại-ngày-432022">THỨ 6 HỌC LẠI (NGÀY 4/3/2022)</h4>

<hr />

<h4 id="soạn-bài-buổi-2">Soạn bài buổi 2</h4>

<h5 id="iv-định-nghĩa-biến-trong-sql-và-câu-lệnh-execute-chuỗi">IV. Định nghĩa biến trong SQL và câu lệnh EXECUTE (“Chuỗi”)</h5>

<ol>
  <li>Biến trong SQL</li>
</ol>

<ul>
  <li>Để khai báo biến trong SQL Server, ta sử dụng câu lệnh <code class="language-plaintext highlighter-rouge">DECLARE</code>, cú pháp như sau:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">DECLARE @&lt;Tên biến&gt; &lt;Kiểu dữ liệu của biến&gt; [= Giá trị gán cho biến]</code></p>

<ul>
  <li>
    <Tên biến="">: Tên của biến. Đối với Bravo thì yêu cầu có dấu gạch '_' trước tên của biến

</Tên>
  </li>
  <li>
    <Kiểu dữ="" liệu="">: Kiểu dữ liệu định nghĩa cho biến

</Kiểu>
  </li>
  <li></li>
  <li>Ví dụ: Để khai báo biến ItemCode thì khai báo như sau:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">DECLARE @_Itemcode NVARCHAR(16)</code></p>

<ol>
  <li>Câu lệnh <code class="language-plaintext highlighter-rouge">EXECUTE('Chuỗi')</code></li>
</ol>

<ul>
  <li>
    <p>Cấu trúc <code class="language-plaintext highlighter-rouge">EXECUTE('SELECT * FROM Item')</code></p>
  </li>
  <li>
    <p>Nguyên tắc biến câu lệnh Query SQL thành chuỗi trong câu lệnh EXECUTE():</p>
  </li>
  <li>
    <p>Thêm 2 dấu nháy đơn vào đằng trước và đằng sau câu lệnh</p>
  </li>
  <li>
    <p>Với mỗi dấu nháy đơn ở câu lệnh Query SQL thông thường khi vào chuỗi để sử dụng trong Câu lệnh EXECUTE thì sẽ thêm 1 dấu nháy nữa</p>
  </li>
</ul>

<p>Ví dụ:</p>

<p><code class="language-plaintext highlighter-rouge">SELECT * FROM Item WHERE ItemCode = 'TP01'</code></p>

<ul>
  <li>Trường hợp muốn công ký tự đặc biệt vào chuỗi thì dùng hàm CHAR(Mã KeyAscii)</li>
</ul>

<p>Ví dụ:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">CHAR(13)</code> -&gt; Ký tự Enter</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">CHAR(39)</code> -&gt; Ký tự nháy đơn</p>
  </li>
</ul>

<h5 id="v-hàm-ngày-tháng">V. Hàm ngày tháng</h5>

<ol>
  <li>Hàm ngày tháng</li>
</ol>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">GETDATE()</code>: Trả về ngày giờ hiện hành</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">GETUTCDATE()</code>: Trả về ngày và giờ UTC hiện tại</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">CURRENT_TIMESTAMP</code>: Trả về ngày giờ hiện hành</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">DATEADD(interval, number, date)</code>: trả về một ngày mà sau đó một khoảng thời gian/ngày nhất định đã được thêm vào</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">interval</code>: Nó có thể là một trong những giá trị sau</p>
  </li>
</ul>

<p><code class="language-plaintext highlighter-rouge">year, yyyy,yy</code> - Khoảng thời gian năm</p>

<p><code class="language-plaintext highlighter-rouge">quarter,qq,q</code> - Khoảng thời gian quý</p>

<p><code class="language-plaintext highlighter-rouge">month, mm,m</code> - Khoảng thời gian tháng</p>

<p><code class="language-plaintext highlighter-rouge">dayofyear</code> - Ngày trong năm</p>

<p><code class="language-plaintext highlighter-rouge">day,dy,y</code> - Khoảng thời gian trong ngày</p>

<p><code class="language-plaintext highlighter-rouge">week, ww,wk</code> - Khoảng thời gian trong tuần</p>

<p><code class="language-plaintext highlighter-rouge">weekday, dw,w</code> - Khoảng thời gian các ngày trong tuần</p>

<p><code class="language-plaintext highlighter-rouge">hour, hh</code> - Khoảng thời gian chờ</p>

<p><code class="language-plaintext highlighter-rouge">minute, mi,n</code> - Khoảng thời gian phút</p>

<p><code class="language-plaintext highlighter-rouge">second, ss, s</code> - Khoảng thời gian giây</p>

<p><code class="language-plaintext highlighter-rouge">millisecond, ms</code> - Khoảng thời gian micro giây</p>

<ul>
  <li>
    <p>number: Số lượng khoảng thời gian muốn thêm</p>
  </li>
  <li>
    <p>date: Ngày mà khoảng thời gian được thêm vào</p>
  </li>
</ul>

<p>Note: <code class="language-plaintext highlighter-rouge">SET DATEFORMAT DMY</code></p>

<ul>
  <li>Ví dụ:</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">DATEADD</span><span class="p">(</span><span class="nb">year</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'2022/04/06'</span><span class="p">)</span>
<span class="c1">--Ket qua: '2025-06-04 00:00:00.000'</span>
<span class="k">SELECT</span> <span class="n">DATEADD</span><span class="p">(</span><span class="n">yyyy</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">'2022/04/06'</span><span class="p">)</span>
<span class="c1">--Ket qua: '2026-06-04 00:00:00.000</span>
<span class="k">SELECT</span> <span class="n">DATEADD</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">'2022/04/06'</span><span class="p">);</span>
<span class="c1">--Ket qua: '2031-06-04 00:00:00.000'</span>
<span class="k">SELECT</span> <span class="n">DATEADD</span><span class="p">(</span><span class="nb">year</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">'2022/04/06'</span><span class="p">);</span>
<span class="c1">--Ket qua: '2020-06-04 00:00:00.000'</span>
<span class="k">SELECT</span> <span class="n">DATEADD</span><span class="p">(</span><span class="k">month</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">'2022/04/06'</span><span class="p">);</span>
<span class="c1">--Ket qua: '2023-02-04 00:00:00.000'</span>
<span class="k">SELECT</span> <span class="n">DATEADD</span><span class="p">(</span><span class="k">month</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="s1">'2022/04/06'</span><span class="p">);</span>
<span class="c1">--Ket qua: '2021-12-04 00:00:00.000'</span>
<span class="k">SELECT</span> <span class="n">DATEADD</span><span class="p">(</span><span class="k">day</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">'2022/04/06'</span><span class="p">);</span>
<span class="c1">--Ket qua: '2022-06-08 00:00:00.000'</span>
<span class="k">SELECT</span> <span class="n">DATEADD</span><span class="p">(</span><span class="k">day</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">'2022/04/06'</span><span class="p">);</span>
<span class="c1">--Ket qua: '2022-05-30 00:00:00.000'</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">DATEDIFF(interval, date1, date2)</code>: trả về chênh lệch giữa hai giá trị ngày, dựa trên khoảng thời gian được chỉ định.</p>


      </article>

      
        <div class="blog-tags">
          <span>Tags:</span>
          
            <a href="/tags#mysql">mysql</a>
          
        </div>
      

      

      
        <!-- Check if any share-links are active -->




<section id = "social-share-section">
  <span class="sr-only">Share: </span>

  
    <a href="https://twitter.com/intent/tweet?text=Mysql+and+SQL+Server+Training&url=http%3A%2F%2Flocalhost%3A4000%2F2022-01-30-mysql%2F"
      class="btn btn-social-icon btn-twitter" title="Share on Twitter">
      <span class="fab fa-fw fa-twitter" aria-hidden="true"></span>
      <span class="sr-only">Twitter</span>
    </a>
  

  
    <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2022-01-30-mysql%2F"
      class="btn btn-social-icon btn-facebook" title="Share on Facebook">
      <span class="fab fa-fw fa-facebook" aria-hidden="true"></span>
      <span class="sr-only">Facebook</span>
    </a>
  

  
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2F2022-01-30-mysql%2F"
      class="btn btn-social-icon btn-linkedin" title="Share on LinkedIn">
      <span class="fab fa-fw fa-linkedin" aria-hidden="true"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  

  

</section>



      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/2022-01-29-javascript-learning/" data-toggle="tooltip" data-placement="top" title="JavaScript Learning">&larr; Previous Post</a>
        </li>
        
        
        <li class="page-item next">
          <a class="page-link" href="/2022-02-10-Algorithm/" data-toggle="tooltip" data-placement="top" title="Luyện thuật toán">Next Post &rarr;</a>
        </li>
        
      </ul>
      
  
  
  

  




    </div>
  </div>
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="/feed.xml" title="RSS">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">RSS</span>
    </a>
  </li><li class="list-inline-item">
    <a href="mailto:tritanngo99@gmail.com" title="Email me">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Email me</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://www.facebook.com/deanattali" title="Facebook">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Facebook</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://github.com/daattali" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://twitter.com/daattali" title="Twitter">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Twitter</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://www.youtube.com/c/daattali" title="YouTube">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">YouTube</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://patreon.com/DeanAttali" title="Patreon">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-patreon fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Patreon</span>
    </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
        Ngô Tấn Trí
        &nbsp;&bull;&nbsp;
      
      2022

      
        &nbsp;&bull;&nbsp;
        <span class="author-site">
          <a href="http://localhost:4000/">MyWebsite.com</a>
        </span>
      

      
      </p>
      <p class="theme-by text-muted">
        Powered by
        <a href="https://beautifuljekyll.com">Beautiful Jekyll</a>
      </p>
      </div>
    </div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
